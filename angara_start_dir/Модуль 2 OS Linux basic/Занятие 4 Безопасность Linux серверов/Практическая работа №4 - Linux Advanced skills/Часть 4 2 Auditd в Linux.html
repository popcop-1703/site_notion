<html>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>Часть 4.2 Auditd в Linux</title>
	<style>
		/* cspell:disable-file */
		/* webkit printing magic: print all background colors */
		html {
			-webkit-print-color-adjust: exact;
		}

		* {
			box-sizing: border-box;
			-webkit-print-color-adjust: exact;
		}

		html,
		body {
			margin: 0;
			padding: 0;
		}

		@media only screen {
			body {
				margin: 2em auto;
				max-width: 900px;
				color: rgb(55, 53, 47);
			}
		}

		body {
			line-height: 1.5;
			/* white-space: pre-wrap; */
		}

		a,
		a.visited {
			color: inherit;
			text-decoration: underline;
		}

		.pdf-relative-link-path {
			font-size: 80%;
			color: #444;
		}

		h1,
		h2,
		h3 {
			letter-spacing: -0.01em;
			line-height: 1.2;
			font-weight: 600;
			margin-bottom: 0;
		}

		.page-title {
			font-size: 2.5rem;
			font-weight: 700;
			margin-top: 0;
			margin-bottom: 0.75em;
		}

		h1 {
			font-size: 1.875rem;
			margin-top: 1.875rem;
		}

		h2 {
			font-size: 1.5rem;
			margin-top: 1.5rem;
		}

		h3 {
			font-size: 1.25rem;
			margin-top: 1.25rem;
		}

		.source {
			border: 1px solid #ddd;
			border-radius: 3px;
			padding: 1.5em;
			word-break: break-all;
		}

		.callout {
			border-radius: 3px;
			padding: 1rem;
		}

		figure {
			margin: 1.25em 0;
			page-break-inside: avoid;
		}

		figcaption {
			opacity: 0.5;
			font-size: 85%;
			margin-top: 0.5em;
		}

		mark {
			background-color: transparent;
		}

		.indented {
			padding-left: 1.5em;
		}

		hr {
			background: transparent;
			display: block;
			width: 100%;
			height: 1px;
			visibility: visible;
			border: none;
			border-bottom: 1px solid rgba(55, 53, 47, 0.09);
		}

		img {
			max-width: 100%;
		}

		@media only print {
			img {
				max-height: 100vh;
				object-fit: contain;
			}
		}

		@page {
			margin: 1in;
		}

		.collection-content {
			font-size: 0.875rem;
		}

		.column-list {
			display: flex;
			justify-content: space-between;
		}

		.column {
			padding: 0 1em;
		}

		.column:first-child {
			padding-left: 0;
		}

		.column:last-child {
			padding-right: 0;
		}

		.table_of_contents-item {
			display: block;
			font-size: 0.875rem;
			line-height: 1.3;
			padding: 0.125rem;
		}

		.table_of_contents-indent-1 {
			margin-left: 1.5rem;
		}

		.table_of_contents-indent-2 {
			margin-left: 3rem;
		}

		.table_of_contents-indent-3 {
			margin-left: 4.5rem;
		}

		.table_of_contents-link {
			text-decoration: none;
			opacity: 0.7;
			border-bottom: 1px solid rgba(55, 53, 47, 0.18);
		}

		table,
		th,
		td {
			border: 1px solid rgba(55, 53, 47, 0.09);
			border-collapse: collapse;
		}

		table {
			border-left: none;
			border-right: none;
		}

		th,
		td {
			font-weight: normal;
			padding: 0.25em 0.5em;
			line-height: 1.5;
			min-height: 1.5em;
			text-align: left;
		}

		th {
			color: rgba(55, 53, 47, 0.6);
		}

		ol,
		ul {
			margin: 0;
			margin-block-start: 0.6em;
			margin-block-end: 0.6em;
		}

		li>ol:first-child,
		li>ul:first-child {
			margin-block-start: 0.6em;
		}

		ul>li {
			list-style: disc;
		}

		ul.to-do-list {
			padding-inline-start: 0;
		}

		ul.to-do-list>li {
			list-style: none;
		}

		.to-do-children-checked {
			text-decoration: line-through;
			opacity: 0.375;
		}

		ul.toggle>li {
			list-style: none;
		}

		ul {
			padding-inline-start: 1.7em;
		}

		ul>li {
			padding-left: 0.1em;
		}

		ol {
			padding-inline-start: 1.6em;
		}

		ol>li {
			padding-left: 0.2em;
		}

		.mono ol {
			padding-inline-start: 2em;
		}

		.mono ol>li {
			text-indent: -0.4em;
		}

		.toggle {
			padding-inline-start: 0em;
			list-style-type: none;
		}

		/* Indent toggle children */
		.toggle>li>details {
			padding-left: 1.7em;
		}

		.toggle>li>details>summary {
			margin-left: -1.1em;
		}

		.selected-value {
			display: inline-block;
			padding: 0 0.5em;
			background: rgba(206, 205, 202, 0.5);
			border-radius: 3px;
			margin-right: 0.5em;
			margin-top: 0.3em;
			margin-bottom: 0.3em;
			white-space: nowrap;
		}

		.collection-title {
			display: inline-block;
			margin-right: 1em;
		}

		.page-description {
			margin-bottom: 2em;
		}

		.simple-table {
			margin-top: 1em;
			font-size: 0.875rem;
			empty-cells: show;
		}

		.simple-table td {
			height: 29px;
			min-width: 120px;
		}

		.simple-table th {
			height: 29px;
			min-width: 120px;
		}

		.simple-table-header-color {
			background: rgb(247, 246, 243);
			color: black;
		}

		.simple-table-header {
			font-weight: 500;
		}

		time {
			opacity: 0.5;
		}

		.icon {
			display: inline-block;
			max-width: 1.2em;
			max-height: 1.2em;
			text-decoration: none;
			vertical-align: text-bottom;
			margin-right: 0.5em;
		}

		img.icon {
			border-radius: 3px;
		}

		.user-icon {
			width: 1.5em;
			height: 1.5em;
			border-radius: 100%;
			margin-right: 0.5rem;
		}

		.user-icon-inner {
			font-size: 0.8em;
		}

		.text-icon {
			border: 1px solid #000;
			text-align: center;
		}

		.page-cover-image {
			display: block;
			object-fit: cover;
			width: 100%;
			max-height: 30vh;
		}

		.page-header-icon {
			font-size: 3rem;
			margin-bottom: 1rem;
		}

		.page-header-icon-with-cover {
			margin-top: -0.72em;
			margin-left: 0.07em;
		}

		.page-header-icon img {
			border-radius: 3px;
		}

		.link-to-page {
			margin: 1em 0;
			padding: 0;
			border: none;
			font-weight: 500;
		}

		p>.user {
			opacity: 0.5;
		}

		td>.user,
		td>time {
			white-space: nowrap;
		}

		input[type="checkbox"] {
			transform: scale(1.5);
			margin-right: 0.6em;
			vertical-align: middle;
		}

		p {
			margin-top: 0.5em;
			margin-bottom: 0.5em;
		}

		.image {
			border: none;
			margin: 1.5em 0;
			padding: 0;
			border-radius: 0;
			text-align: center;
		}

		.code,
		code {
			background: rgba(135, 131, 120, 0.15);
			border-radius: 3px;
			padding: 0.2em 0.4em;
			border-radius: 3px;
			font-size: 85%;
			tab-size: 2;
		}

		code {
			color: #eb5757;
		}

		.code {
			padding: 1.5em 1em;
		}

		.code-wrap {
			white-space: pre-wrap;
			word-break: break-all;
		}

		.code>code {
			background: none;
			padding: 0;
			font-size: 100%;
			color: inherit;
		}

		blockquote {
			font-size: 1.25em;
			margin: 1em 0;
			padding-left: 1em;
			border-left: 3px solid rgb(55, 53, 47);
		}

		.bookmark {
			text-decoration: none;
			max-height: 8em;
			padding: 0;
			display: flex;
			width: 100%;
			align-items: stretch;
		}

		.bookmark-title {
			font-size: 0.85em;
			overflow: hidden;
			text-overflow: ellipsis;
			height: 1.75em;
			white-space: nowrap;
		}

		.bookmark-text {
			display: flex;
			flex-direction: column;
		}

		.bookmark-info {
			flex: 4 1 180px;
			padding: 12px 14px 14px;
			display: flex;
			flex-direction: column;
			justify-content: space-between;
		}

		.bookmark-image {
			width: 33%;
			flex: 1 1 180px;
			display: block;
			position: relative;
			object-fit: cover;
			border-radius: 1px;
		}

		.bookmark-description {
			color: rgba(55, 53, 47, 0.6);
			font-size: 0.75em;
			overflow: hidden;
			max-height: 4.5em;
			word-break: break-word;
		}

		.bookmark-href {
			font-size: 0.75em;
			margin-top: 0.25em;
		}

		.sans {
			font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol";
		}

		.code {
			font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;
		}

		.serif {
			font-family: Lyon-Text, Georgia, ui-serif, serif;
		}

		.mono {
			font-family: iawriter-mono, Nitti, Menlo, Courier, monospace;
		}

		.pdf .sans {
			font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP';
		}

		.pdf:lang(zh-CN) .sans {
			font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC';
		}

		.pdf:lang(zh-TW) .sans {
			font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC';
		}

		.pdf:lang(ko-KR) .sans {
			font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR';
		}

		.pdf .code {
			font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP';
		}

		.pdf:lang(zh-CN) .code {
			font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC';
		}

		.pdf:lang(zh-TW) .code {
			font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC';
		}

		.pdf:lang(ko-KR) .code {
			font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR';
		}

		.pdf .serif {
			font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP';
		}

		.pdf:lang(zh-CN) .serif {
			font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC';
		}

		.pdf:lang(zh-TW) .serif {
			font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC';
		}

		.pdf:lang(ko-KR) .serif {
			font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR';
		}

		.pdf .mono {
			font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP';
		}

		.pdf:lang(zh-CN) .mono {
			font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC';
		}

		.pdf:lang(zh-TW) .mono {
			font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC';
		}

		.pdf:lang(ko-KR) .mono {
			font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR';
		}

		.highlight-default {
			color: rgba(55, 53, 47, 1);
		}

		.highlight-gray {
			color: rgba(120, 119, 116, 1);
			fill: rgba(120, 119, 116, 1);
		}

		.highlight-brown {
			color: rgba(159, 107, 83, 1);
			fill: rgba(159, 107, 83, 1);
		}

		.highlight-orange {
			color: rgba(217, 115, 13, 1);
			fill: rgba(217, 115, 13, 1);
		}

		.highlight-yellow {
			color: rgba(203, 145, 47, 1);
			fill: rgba(203, 145, 47, 1);
		}

		.highlight-teal {
			color: rgba(68, 131, 97, 1);
			fill: rgba(68, 131, 97, 1);
		}

		.highlight-blue {
			color: rgba(51, 126, 169, 1);
			fill: rgba(51, 126, 169, 1);
		}

		.highlight-purple {
			color: rgba(144, 101, 176, 1);
			fill: rgba(144, 101, 176, 1);
		}

		.highlight-pink {
			color: rgba(193, 76, 138, 1);
			fill: rgba(193, 76, 138, 1);
		}

		.highlight-red {
			color: rgba(212, 76, 71, 1);
			fill: rgba(212, 76, 71, 1);
		}

		.highlight-default_background {
			color: rgba(55, 53, 47, 1);
		}

		.highlight-gray_background {
			background: rgba(241, 241, 239, 1);
		}

		.highlight-brown_background {
			background: rgba(244, 238, 238, 1);
		}

		.highlight-orange_background {
			background: rgba(251, 236, 221, 1);
		}

		.highlight-yellow_background {
			background: rgba(251, 243, 219, 1);
		}

		.highlight-teal_background {
			background: rgba(237, 243, 236, 1);
		}

		.highlight-blue_background {
			background: rgba(231, 243, 248, 1);
		}

		.highlight-purple_background {
			background: rgba(244, 240, 247, 0.8);
		}

		.highlight-pink_background {
			background: rgba(249, 238, 243, 0.8);
		}

		.highlight-red_background {
			background: rgba(253, 235, 236, 1);
		}

		.block-color-default {
			color: inherit;
			fill: inherit;
		}

		.block-color-gray {
			color: rgba(120, 119, 116, 1);
			fill: rgba(120, 119, 116, 1);
		}

		.block-color-brown {
			color: rgba(159, 107, 83, 1);
			fill: rgba(159, 107, 83, 1);
		}

		.block-color-orange {
			color: rgba(217, 115, 13, 1);
			fill: rgba(217, 115, 13, 1);
		}

		.block-color-yellow {
			color: rgba(203, 145, 47, 1);
			fill: rgba(203, 145, 47, 1);
		}

		.block-color-teal {
			color: rgba(68, 131, 97, 1);
			fill: rgba(68, 131, 97, 1);
		}

		.block-color-blue {
			color: rgba(51, 126, 169, 1);
			fill: rgba(51, 126, 169, 1);
		}

		.block-color-purple {
			color: rgba(144, 101, 176, 1);
			fill: rgba(144, 101, 176, 1);
		}

		.block-color-pink {
			color: rgba(193, 76, 138, 1);
			fill: rgba(193, 76, 138, 1);
		}

		.block-color-red {
			color: rgba(212, 76, 71, 1);
			fill: rgba(212, 76, 71, 1);
		}

		.block-color-default_background {
			color: inherit;
			fill: inherit;
		}

		.block-color-gray_background {
			background: rgba(241, 241, 239, 1);
		}

		.block-color-brown_background {
			background: rgba(244, 238, 238, 1);
		}

		.block-color-orange_background {
			background: rgba(251, 236, 221, 1);
		}

		.block-color-yellow_background {
			background: rgba(251, 243, 219, 1);
		}

		.block-color-teal_background {
			background: rgba(237, 243, 236, 1);
		}

		.block-color-blue_background {
			background: rgba(231, 243, 248, 1);
		}

		.block-color-purple_background {
			background: rgba(244, 240, 247, 0.8);
		}

		.block-color-pink_background {
			background: rgba(249, 238, 243, 0.8);
		}

		.block-color-red_background {
			background: rgba(253, 235, 236, 1);
		}

		.select-value-color-uiBlue {
			background-color: rgba(35, 131, 226, .07);
		}

		.select-value-color-pink {
			background-color: rgba(245, 224, 233, 1);
		}

		.select-value-color-purple {
			background-color: rgba(232, 222, 238, 1);
		}

		.select-value-color-green {
			background-color: rgba(219, 237, 219, 1);
		}

		.select-value-color-gray {
			background-color: rgba(227, 226, 224, 1);
		}

		.select-value-color-transparentGray {
			background-color: rgba(227, 226, 224, 0);
		}

		.select-value-color-translucentGray {
			background-color: rgba(0, 0, 0, 0.06);
		}

		.select-value-color-orange {
			background-color: rgba(250, 222, 201, 1);
		}

		.select-value-color-brown {
			background-color: rgba(238, 224, 218, 1);
		}

		.select-value-color-red {
			background-color: rgba(255, 226, 221, 1);
		}

		.select-value-color-yellow {
			background-color: rgba(253, 236, 200, 1);
		}

		.select-value-color-blue {
			background-color: rgba(211, 229, 239, 1);
		}

		.select-value-color-pageGlass {
			background-color: undefined;
		}

		.select-value-color-washGlass {
			background-color: undefined;
		}

		.checkbox {
			display: inline-flex;
			vertical-align: text-bottom;
			width: 16;
			height: 16;
			background-size: 16px;
			margin-left: 2px;
			margin-right: 5px;
		}
	</style>
</head>

<body>
	<article id="131aa64c-9d0a-8137-a127-e9e5534fb0bc" class="page sans">
		<header><img class="page-cover-image"
				src="Часть 4 2 Auditd в Linux/kandinsky-download-1705860521857.png"
				style="object-position:center 50%" />
			<div class="page-header-icon page-header-icon-with-cover"><img class="icon"
					src="https://www.notion.so/icons/chart_gray.svg" /></div>
			<h1 class="page-title"><strong>Часть 4.2 Auditd в Linux</strong></h1>
			<p class="page-description"></p>
		</header>
		<div class="page-body">
			<p id="131aa64c-9d0a-81ac-9365-e94037ea2b56" class="">
			</p>
			<figure id="131aa64c-9d0a-81df-80ef-fb286e70a77f" class="image"><a
					href="Часть 4 2 Auditd в Linux/Untitled.png"><img
						style="width:1542px"
						src="Часть 4 2 Auditd в Linux/Untitled.png" /></a>
			</figure>
			<details open="">
				<summary style="font-weight:600;font-size:1.25em;line-height:1.3;margin:0">План работы</summary>
				<div class="indented">
					<nav id="131aa64c-9d0a-81a3-9e5f-eb653d925639" class="block-color-gray table_of_contents">
						<div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link"
								href="#131aa64c-9d0a-81b0-b78f-f615ca3cf316">План работы</a></div>
						<div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link"
								href="#131aa64c-9d0a-81ef-a351-e37faf055f72"><strong>Цель работы:</strong></a></div>
						<div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link"
								href="#131aa64c-9d0a-8115-83d4-f41516887a6c"><strong>Задача:</strong></a></div>
						<div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link"
								href="#131aa64c-9d0a-8173-98ea-d2b9603f00b3"><strong>Отчёт:</strong></a></div>
						<div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link"
								href="#131aa64c-9d0a-8124-aec0-e10d50401da7">1. <strong>Общее описание
									auditd</strong></a></div>
						<div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link"
								href="#131aa64c-9d0a-8169-a920-c5e4256bc6fd">2. <strong>Конфигурирование</strong></a>
						</div>
						<div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
								href="#131aa64c-9d0a-8104-a229-ce22e4f60ba9">2.1 <strong>Правила аудита</strong></a>
						</div>
						<div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
								href="#131aa64c-9d0a-810f-9a67-e471ec247621">2.2 <strong>Конфигурационные
									файлы</strong></a></div>
						<div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
								href="#131aa64c-9d0a-81a3-a36e-e440c1e2b18e">2.2.1 Написание своего правила</a></div>
						<div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
								href="#131aa64c-9d0a-8161-9fd9-e5a58a2e892d">2.2.2 Редактирование файла</a></div>
						<div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
								href="#131aa64c-9d0a-81ad-8062-c5d1a0902976">2.2.3 Проверка аудита</a></div>
						<div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link"
								href="#131aa64c-9d0a-818d-90e3-dd811fa99eb1">3. Создание о<strong>тчёта</strong></a>
						</div>
						<div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link"
								href="#131aa64c-9d0a-8145-b4b0-ecbc58db5f6c">4. <strong>Постоянный аудит</strong></a>
						</div>
						<div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link"
								href="#131aa64c-9d0a-8187-b063-d3f390f9172f">5. Выполнить практику </a></div>
						<div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link"
								href="#131aa64c-9d0a-8111-a0af-e4fa3e1e258c"><strong>Вывод</strong></a></div>
					</nav>
				</div>
			</details>
			<h3 id="131aa64c-9d0a-81ef-a351-e37faf055f72" class=""><strong>Цель работы:</strong></h3>
			<ul id="131aa64c-9d0a-8102-b62e-c92b1dff5903" class="bulleted-list">
				<li style="list-style-type:disc">Необходимо разобраться как работает auditd.</li>
			</ul>
			<h3 id="131aa64c-9d0a-8115-83d4-f41516887a6c" class=""><strong>Задача:</strong></h3>
			<ul id="131aa64c-9d0a-815a-9607-eea6f1a6e2d8" class="bulleted-list">
				<li style="list-style-type:disc">Проделать практическую работу в терминале;</li>
			</ul>
			<h3 id="131aa64c-9d0a-8173-98ea-d2b9603f00b3" class=""><strong>Отчёт:</strong></h3>
			<ul id="131aa64c-9d0a-817b-9b13-c71f20ce85a7" class="bulleted-list">
				<li style="list-style-type:disc">Продемонстрировать все правила;</li>
			</ul>
			<ul id="131aa64c-9d0a-81e9-a42a-f6226f48b609" class="bulleted-list">
				<li style="list-style-type:disc">Предоставить отчёт со скриншотами и описанием к ним.</li>
			</ul>
			<h1 id="131aa64c-9d0a-8124-aec0-e10d50401da7" class="">1. <strong>Общее описание auditd</strong></h1>
			<figure class="block-color-gray_background callout" style=" display:flex"
				id="131aa64c-9d0a-81cf-94e0-fe0265c79f59">
				<div style="font-size:1.5em"><span class="icon">💡</span></div>
				<div style="width:100%">Одной из важных составляющих информационной безопасности инфраструктуры компании
					является SIEM — система управлением событиями и информацией безопасности. <br /><br />Такую систему
					можно условно поделить на 2 основные части — подсистему сбора событий и подсистему анализа
					полученных событий. Правильная настройка первой поможет обнаружить вторжение на ранних этапах
					проникновения, облегчит написание событий тревоги (алертов), а если вас всё-таки взломали, то
					позволит разобраться, как и почему это произошло, какие действия выполняли злоумышленники. <br />
				</div>
			</figure>
			<p id="131aa64c-9d0a-81e6-be74-f92701b25aa8" class="">Основным инструментом для сбора системных событий в
				линукс-системах является auditd. На основе этого инструмента созданы и другие, например, auditbeat,
				go-audit, которые дополняют основной функционал auditd. Поэтому, разобравшись с основными принципами
				работы базового инструмента, вам не составит труда воспользоваться и всеми остальными.</p>
			<figure class="block-color-blue_background callout" style=" display:flex"
				id="131aa64c-9d0a-81ae-b0de-c698ae3295f7">
				<div style="font-size:1.5em"><span class="icon">ℹ️</span></div>
				<div style="width:100%"><strong>auditd</strong> (сокращение от Linux Audit Daemon) — нативный инструмент
					предназначенный для мониторинга событий операционной системы и записи их в журналы событий,
					разрабатываемый и поддерживаемый компанией RedHat. <br /><br />Был создан для тесного взаимодействия
					с ядром операционной системы — во время своей работы наблюдает за системными вызовами и может
					записывать события — чтение, запись, выполнение, изменение прав - связанные с файлами ОС.
					<br /><br />Таким образом, с его помощью можно отслеживать практически любые события, происходящие в
					операционной системе.<br /></div>
			</figure>
			<p id="131aa64c-9d0a-811e-9981-d2dff5ebdfd7" class=""><strong>Плюсы auditd:</strong></p>
			<ul id="131aa64c-9d0a-814a-a37f-ec61d15a5e56" class="bulleted-list">
				<li style="list-style-type:disc">работает на низком уровне мониторинга — отслеживает системные вызовы и
					действия с файлами;</li>
			</ul>
			<ul id="131aa64c-9d0a-8182-8f3e-e7a0e0a67095" class="bulleted-list">
				<li style="list-style-type:disc">имеет неплохой набор утилит в комплекте для удобства работы;</li>
			</ul>
			<ul id="131aa64c-9d0a-813d-821c-cc041fd1cb78" class="bulleted-list">
				<li style="list-style-type:disc">постоянно развивается и обновляется;</li>
			</ul>
			<ul id="131aa64c-9d0a-8161-9ffa-e482f2d251d8" class="bulleted-list">
				<li style="list-style-type:disc">бесплатен и легко устанавливается.</li>
			</ul>
			<p id="131aa64c-9d0a-81fa-add6-feace98be42c" class=""><strong>Минусы auditd:</strong></p>
			<ul id="131aa64c-9d0a-8198-b7f1-c33cd62bd639" class="bulleted-list">
				<li style="list-style-type:disc">большинство событий, возникающих при атаках характерных для конкретного
					приложения, практически невозможно отслеживать поскольку на уровне системных вызовов и работе с
					файлами трудно отличить взлом от нормальной работы приложения. Такие события лучше отслеживать на
					уровне самих приложений;</li>
			</ul>
			<ul id="131aa64c-9d0a-8187-8e54-c4b7721cc132" class="bulleted-list">
				<li style="list-style-type:disc">auditd может замедлять работу ОС. Это связанно с тем, что подсистеме
					аудита необходимо проводить анализ системных вызовов;</li>
			</ul>
			<ul id="131aa64c-9d0a-81cb-9d04-d3d47d929dec" class="bulleted-list">
				<li style="list-style-type:disc">не слишком гибок в настройке правил;</li>
			</ul>
			<ul id="131aa64c-9d0a-8117-9ea1-c410261e29fe" class="bulleted-list">
				<li style="list-style-type:disc">на данный момент это не лучший инструмент для работы с контейнерами.
				</li>
			</ul>
			<p id="131aa64c-9d0a-8181-92ab-eb56bab9d5d7" class=""><strong>Установка:</strong></p>
			<p id="131aa64c-9d0a-81b8-b203-e05afe93e2ee" class=""><em><strong>По умолчанию auditd не интегрирован в
						операционную систему.</strong></em></p>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
				integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
				crossorigin="anonymous" referrerPolicy="no-referrer"></script>
			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
				integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
				crossorigin="anonymous" referrerPolicy="no-referrer" />
			<pre id="131aa64c-9d0a-81e7-b9ed-ef0816eb1d49"
				class="code"><code class="language-Bash">sudo apt-get install auditd</code></pre>
			<figure id="131aa64c-9d0a-81fe-b426-e3d6dfd04368" class="image"><a
					href="https://i.imgur.com/89tLhjx.png"><img src="https://i.imgur.com/89tLhjx.png" /></a></figure>
			<p id="131aa64c-9d0a-8130-84d1-ef0d4c1667fb" class="">далее проверим работоспособность сервиса:</p>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
				integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
				crossorigin="anonymous" referrerPolicy="no-referrer"></script>
			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
				integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
				crossorigin="anonymous" referrerPolicy="no-referrer" />
			<pre id="131aa64c-9d0a-8140-a8fc-dd3810d2ec1a"
				class="code"><code class="language-Bash">sudo service auditd status</code></pre>
			<figure id="131aa64c-9d0a-81c9-a84c-d482f4839521" class="image"><a
					href="https://i.imgur.com/TQTKPVo.png"><img src="https://i.imgur.com/TQTKPVo.png" /></a></figure>
			<h1 id="131aa64c-9d0a-8169-a920-c5e4256bc6fd" class="">2. <strong>Конфигурирование</strong></h1>
			<p id="131aa64c-9d0a-811f-b826-db9f342a62f4" class="">Системные параметры хранятся в двух файлах. Первый
				называется auditd.conf и содержит настройки сервиса аудита, второй называется audit.rules. Audit.conf
				отвечает за сервис auditd по направлению какие события он записывает и в каком моменте времени. Второй
				файл содержит в себе правила и фильтры, используемые auditd при выполнении операций. В него
				администраторы вносят изменения, добавляют новые правила, а также правят текущие шаблоны или удаляют
				устаревшие.</p>
			<p id="131aa64c-9d0a-81cd-98ea-e6ad3b4a0e37" class="">Для просмотра установленных шаблонов используем
				следующий флаг:</p>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
				integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
				crossorigin="anonymous" referrerPolicy="no-referrer"></script>
			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
				integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
				crossorigin="anonymous" referrerPolicy="no-referrer" />
			<pre id="131aa64c-9d0a-8151-8866-c02322ad21b4"
				class="code"><code class="language-Bash">auditctl –l</code></pre>
			<figure id="131aa64c-9d0a-8145-8481-f6075da0b29f" class="image"><a
					href="https://i.imgur.com/c8qOILd.png"><img style="width:720px"
						src="https://i.imgur.com/c8qOILd.png" /></a></figure>
			<p id="131aa64c-9d0a-8196-8c4c-d408d3893291" class=""><em>Если настройки не выполнялись, то таблица будет
					пустой.</em></p>
			<p id="131aa64c-9d0a-81da-b1f7-da74e79d86e3" class=""><strong>Важно! Удаление правил производится через ключ
					D.</strong></p>
			<p id="131aa64c-9d0a-8150-beba-f7de15863c47" class=""><strong>Для активации мониторинга за конкретным файлом
					прописываем следующий синтаксис в терминале:</strong></p>
			<p id="131aa64c-9d0a-8197-8e6d-dcf088d123d1" class="">
				<code>auditctl -a command,action -F path=name_file -F perm=permission</code></p>
			<ul id="131aa64c-9d0a-8139-a02a-c93cb6853be4" class="bulleted-list">
				<li style="list-style-type:disc">name_file — имя файла, за которым ведется наблюдение со стороны сервиса
					auditd;</li>
			</ul>
			<ul id="131aa64c-9d0a-81ae-ba72-defc585cc57b" class="bulleted-list">
				<li style="list-style-type:disc">permission — права на доступ.</li>
			</ul>
			<h2 id="131aa64c-9d0a-8104-a229-ce22e4f60ba9" class="">2.1 <strong>Правила аудита</strong></h2>
			<p id="131aa64c-9d0a-8157-86ab-dc48d476e694" class=""><strong>Для создания, удаления и модификации правил
					аудита предназначена утилита auditctl. Есть основных опции, которые принимает эта команда:</strong>
			</p>
			<ul id="131aa64c-9d0a-81cb-bbc2-d877a6f2d920" class="bulleted-list">
				<li style="list-style-type:disc">a – добавить правило в список;</li>
			</ul>
			<ul id="131aa64c-9d0a-81f4-9eb3-fc461ec5cb25" class="bulleted-list">
				<li style="list-style-type:disc">d – удалить правило из списка;</li>
			</ul>
			<ul id="131aa64c-9d0a-81a8-8c58-f326c974f64b" class="bulleted-list">
				<li style="list-style-type:disc">D – удалить все правила;</li>
			</ul>
			<ul id="131aa64c-9d0a-81b4-8063-fabdc9f7f397" class="bulleted-list">
				<li style="list-style-type:disc">l – вывести список заданных правил.</li>
			</ul>
			<p id="131aa64c-9d0a-811c-a849-f891d0e216b8" class=""><strong>Поле принимает четыре значения:</strong></p>
			<ul id="131aa64c-9d0a-8180-a472-fe364ad2b788" class="bulleted-list">
				<li style="list-style-type:disc">R — права на чтение;</li>
			</ul>
			<ul id="131aa64c-9d0a-8160-bc60-c61d39ef3de9" class="bulleted-list">
				<li style="list-style-type:disc">W — разрешается изменять;</li>
			</ul>
			<ul id="131aa64c-9d0a-8184-870f-f7ac4d8d062a" class="bulleted-list">
				<li style="list-style-type:disc">X — используется для исполняемых файлов, сервис запускает его от своего
					имени;</li>
			</ul>
			<ul id="131aa64c-9d0a-8140-a9f6-fb32f3dcd55f" class="bulleted-list">
				<li style="list-style-type:disc">A — изменить атрибуты объекта.</li>
			</ul>
			<p id="131aa64c-9d0a-8126-ab3b-cd0ca361f52a" class=""><strong>Дополнительные ключи, которые идут совместно с
					командой, расшифровываются следующим образом:</strong></p>
			<ul id="131aa64c-9d0a-81a7-a812-ed31b47688ba" class="bulleted-list">
				<li style="list-style-type:disc"><strong>–a</strong>: обозначает для демона auditctl список (task, exit,
					user или exclude) и действие (never или always). Пара перечисляется через запятую.<ul
						id="131aa64c-9d0a-81a4-b441-d048dcc638aa" class="bulleted-list">
						<li style="list-style-type:circle">task – события, связанные с созданием процессов;</li>
					</ul>
					<ul id="131aa64c-9d0a-8180-b728-d36389b54f74" class="bulleted-list">
						<li style="list-style-type:circle">entry – события, происходящие при входе в системный вызов;
						</li>
					</ul>
					<ul id="131aa64c-9d0a-817d-a49c-f386bc167f76" class="bulleted-list">
						<li style="list-style-type:circle">exit – события, происходящие во время выхода из системного
							вызова;</li>
					</ul>
					<ul id="131aa64c-9d0a-81f7-8826-d36da1ce1c6c" class="bulleted-list">
						<li style="list-style-type:circle">user – события, использующие параметры пользовательского
							пространства, такие как uid, pid и gid;</li>
					</ul>
					<ul id="131aa64c-9d0a-812e-9a39-fc397bfa10cc" class="bulleted-list">
						<li style="list-style-type:circle">exclude – используется для исключения событий.</li>
					</ul>
				</li>
			</ul>
			<ul id="131aa64c-9d0a-814b-a985-c67b047b64df" class="bulleted-list">
				<li style="list-style-type:disc">–F: задает путь к файлу и предоставляет права на поиск.</li>
			</ul>
			<p id="131aa64c-9d0a-81f4-b1f1-d02d3b2e89a6" class=""><strong>Второй пример синтаксиса написания
					правила:</strong></p>
			<p id="131aa64c-9d0a-81a7-9b69-d240f27b20d8" class="">
				<code>auditctl -a список,действие -S имя_системного_вызова -F фильтры</code></p>
			<p id="131aa64c-9d0a-81c8-bd00-e600e71698af" class="">По сути, это всего лишь фильтры, которые позволяют
				сделать правила более точными. На деле из них используются только entry и exit, которые позволяют
				зарегистрировать либо сам факт обращения к системному вызову, либо его успешную отработку.</p>
			<p id="131aa64c-9d0a-8113-8d52-f1f7b6030b24" class="">Второй параметр опции – ‘-a’ – это действие, которое
				должно произойти в ответ на возникшее событие. Их всего два: never и always. В первом случае события не
				записываются в журнал событий, во втором – записываются.</p>
			<p id="131aa64c-9d0a-814a-8249-c6f4baf27156" class="">Далее указывается опция ‘-S’, которая задает имя
				системного вызова, при обращении к которому должен срабатывать триггер (например, open, close, exit, и
				т.д.). Вместо имени может быть использовано числовое значение.</p>
			<p id="131aa64c-9d0a-8140-8b00-d1377a822a6f" class="">Необязательная опция ‘-F’ используется для указания
				дополнительных параметров фильтрации события. Например, если мы хотим вести журнал событий, связанных с
				использованием системного вызова open(), но при этом желаем регистрировать только обращения к файлам
				каталога /etc, то должны использовать следующее правило:</p>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
				integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
				crossorigin="anonymous" referrerPolicy="no-referrer"></script>
			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
				integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
				crossorigin="anonymous" referrerPolicy="no-referrer" />
			<pre id="131aa64c-9d0a-81ea-8504-d8167eb25195"
				class="code"><code class="language-Bash">auditctl -a exit,always -S open -F path=/etc/</code></pre>
			<p id="131aa64c-9d0a-81da-8d70-ea8c348effba" class="">Утилита <strong>auditctl</strong> используется для
				контроля поведения, получения состояния и добавления/удаления правил аудита, предоставляемого Linux
				ядром.<br /><br /></p>
			<ul id="131aa64c-9d0a-8120-8148-c9ebbdbd3f3f" class="toggle">
				<li>
					<details open="">
						<summary><strong>Опции:</strong></summary>
						<table id="131aa64c-9d0a-8158-8e31-ccf05ae6127d" class="simple-table">
							<tbody>
								<tr id="131aa64c-9d0a-819e-aacd-c9235c52e796">
									<td id="AHag" class="" style="width:115px"><strong>Опция</strong></td>
									<td id="we]f" class="" style="width:552px"><strong>Значение опции</strong></td>
								</tr>
								<tr id="131aa64c-9d0a-81d9-b7aa-c2bc868645de">
									<td id="AHag" class="" style="width:115px">
										<code><strong>-b </strong></code><em><code>backlog</code></em></td>
									<td id="we]f" class="" style="width:552px">Установить максимальное количество
										доступных для аудита буферов, ожидающих обработки (значение в ядре по умолчанию
										- 64). Если все буфера заняты, то флаг сбоя будет выставлен ядром для его
										дальнейшей обработки.</td>
								</tr>
								<tr id="131aa64c-9d0a-8140-b2a1-e05784c30f1f">
									<td id="AHag" class="" style="width:115px"><code><strong>-e [0..2]</strong></code>
									</td>
									<td id="we]f" class="" style="width:552px">Установить флаг
										блокировки. <strong>0</strong> позволит на время отключить аудит, включить его
										обратно можно, передав <strong>1</strong> как параметр. Если установлено
										значение опции <strong>2</strong>, то защитить конфигурацию аудита от изменений.
										Каждый, кто захочет воспользоваться этой возможностью, может поставить эту
										команду последней в <strong>audit.rules</strong>. После этой команды все попытки
										изменить конфигурацию будут отвергнуты с уведомлением в журналах аудита. В этом
										случае, чтобы задействовать новую конфигурацию аудита, необходимо перезагрузить
										систему аудита.</td>
								</tr>
								<tr id="131aa64c-9d0a-8151-834e-f159b33f1d7b">
									<td id="AHag" class="" style="width:115px"><code><strong>-f [0..2]</strong></code>
									</td>
									<td id="we]f" class="" style="width:552px">Установить способ обработки для флага
										сбоя. <strong>0</strong>=silent <strong>1</strong>=printk <strong>2</strong>=panic.
										Эта опция позволяет определить, каким образом ядро будет обрабатывать
										критические ошибки. Например, флаг сбоя выставляется при следующих условиях:
										ошибки передачи в пространство службы аудита, превышение лимита буферов,
										ожидающих обработки, выход за пределы памяти ядра, превышение лимита скорости
										выдачи сообщений. Значение по умолчанию: <strong>1</strong>. Для систем с
										повышенными требованиями к безопасности, значение <strong>2</strong> может быть
										более предпочтительно.</td>
								</tr>
								<tr id="131aa64c-9d0a-8158-9e22-f027dec08eb9">
									<td id="AHag" class="" style="width:115px"><code><strong>-h</strong></code></td>
									<td id="we]f" class="" style="width:552px">Краткая помощь по аргументам командной
										строки.</td>
								</tr>
								<tr id="131aa64c-9d0a-81e4-923f-e64bc20749f8">
									<td id="AHag" class="" style="width:115px"><code><strong>-i</strong></code></td>
									<td id="we]f" class="" style="width:552px">Игнорировать ошибки при чтении правил из
										файла.</td>
								</tr>
								<tr id="131aa64c-9d0a-8192-bd4a-e942493137e0">
									<td id="AHag" class="" style="width:115px"><code><strong>-l</strong></code></td>
									<td id="we]f" class="" style="width:552px">Вывести список всех правил по одному
										правилу в строке.</td>
								</tr>
								<tr id="131aa64c-9d0a-81d0-9553-e716ab4919df">
									<td id="AHag" class="" style="width:115px">
										<code><strong>-k</strong></code><code> </code><em><code>&lt;ключ&gt;</code></em>
									</td>
									<td id="we]f" class="" style="width:552px">Установить на правило ключ фильтрации.
										Ключ фильтрации - это произвольная текстовая строка длиной не больше <em>31
											символа</em>. Ключ помогает уникально идентифицировать записи, генерируемые
										в ходе аудита за точкой наблюдения.</td>
								</tr>
								<tr id="131aa64c-9d0a-818c-b896-f3c4dbf13dfa">
									<td id="AHag" class="" style="width:115px">
										<code><strong>-m</strong></code><code> </code><em><code>&lt;текст&gt;</code></em>
									</td>
									<td id="we]f" class="" style="width:552px">Послать в систему аудита пользовательское
										сообщение. Это может быть сделано только из-под учетной
										записи <strong>root</strong>.</td>
								</tr>
								<tr id="131aa64c-9d0a-81d9-b65e-c947c24324d4">
									<td id="AHag" class="" style="width:115px">
										<code><strong>-p [r|w|x|a]</strong></code></td>
									<td id="we]f" class="" style="width:552px">Установить фильтр прав доступа для точки
										наблюдения. <strong>r</strong>=чтение, <strong>w</strong>=запись, <strong>х</strong>=исполнение, <strong>a</strong>=изменение
										атрибута. Не путайте эти права доступа с обычными правами доступа к файлу - они
										определяют типы системных вызовов, которые выполняют данные действия. Заметьте,
										системные вызовы <strong>read</strong> и <strong>write</strong> не включены в
										этот набор, поскольку логи аудита были бы перегружены информацией о работе этих
										вызовов.</td>
								</tr>
								<tr id="131aa64c-9d0a-81f1-abb9-ccb4a9dbff57">
									<td id="AHag" class="" style="width:115px">
										<code><strong>-r</strong></code><code> </code><em><code>&lt;частота&gt;</code></em>
									</td>
									<td id="we]f" class="" style="width:552px">Установить ограничение скорости выдачи
										сообщений в секунду (<strong>0</strong> - нет ограничения). Если эта частота не
										нулевая и она превышается в ходе аудита, флаг сбоя выставляется ядром для
										выполнения соответствующего действия. Значение по умолчанию: <strong>0</strong>.
									</td>
								</tr>
								<tr id="131aa64c-9d0a-81d2-a6d2-e290bc909fe6">
									<td id="AHag" class="" style="width:115px">
										<code><strong>-R</strong></code><code> </code><em><code>&lt;файл&gt;</code></em>
									</td>
									<td id="we]f" class="" style="width:552px">Читать правила из <em>файла</em>. Правила
										должны быть расположены по одному в строке и в том порядке, в каком они должны
										исполняться. Следующие ограничения накладываются на файл: владельцем должен
										быть <strong>root</strong> и доступ на чтение должен быть только у него. Файл
										может содержать комментарии, начинающиеся с символа «<strong>#</strong>».
										Правила, расположенные в файле, идентичны тем, что набираются в командной
										строке, без указания «<strong>auditctl</strong>».</td>
								</tr>
								<tr id="131aa64c-9d0a-81b3-9818-cd7bbfa1d99d">
									<td id="AHag" class="" style="width:115px"><code><strong>-s</strong></code></td>
									<td id="we]f" class="" style="width:552px">Получить статус аудита.</td>
								</tr>
								<tr id="131aa64c-9d0a-81dc-808a-f8ef7119d2fb">
									<td id="AHag" class="" style="width:115px">
										<code><strong>-a</strong></code><code> </code><em><code>&lt;список, действие&gt;</code></em>
									</td>
									<td id="we]f" class="" style="width:552px">Добавить правило с
										указанным <em>действием</em> к концу <em>списка</em>. Заметьте, что запятая
										разделяет эти два значения. Отсутствие запятой вызовет ошибку. Ниже описаны
										имена доступных списков:<br />• <br /><strong>task</strong> - добавить правило к
										списку, отвечающему за процессы. Этот список правил используется только во время
										создания процесса - когда родительский процесс
										вызывает <strong>fork()</strong> или <strong>clone()</strong>. При использовании
										этого списка вы можете использовать только те поля, которые известны во время
										создания процесса: <strong>uid</strong>, <strong>gid</strong> и т.д.<br />•
										<br /><strong>entry</strong> - добавить правило к списку, отвечающему за точки
										входа системных вызовов. Этот список применяется, когда необходимо создать
										событие для аудита, привязанное к точкам входа системных вызовов.<br />•
										<br /><strong>exit</strong> - добавить правило к списку, отвечающему за точки
										выхода из системных вызовов. Этот список применяется, когда необходимо создать
										событие для аудита, привязанное к точкам выхода из системных вызовов.<br />•
										<br /><strong>user</strong> - добавить правило, отвечающее за список фильтрации
										пользовательских сообщений. Этот список используется ядром, чтобы отфильтровать
										события приходящие из пользовательского пространства перед тем, как они будут
										переданы службе аудита. Необходимо отметить, что только следующие поля могут
										быть
										использованы: <strong>uid</strong>, <strong>auid</strong>, <strong>gid</strong> и <strong>pid</strong>.
										Все остальные поля будут обработаны, как если бы они не совпали.<br />•
										<br /><strong>exclude</strong> - добавить правило к списку, отвечающему за
										фильтрацию событий определенного типа. Этот список используется, чтобы
										отфильтровывать ненужные события. Например, если вы не хотите
										видеть <em>avc</em> сообщения, вы должны использовать этот список. Тип сообщения
										задается в поле <strong>msgtype</strong>.</td>
								</tr>
							</tbody>
						</table>
					</details>
				</li>
			</ul>
			<ul id="131aa64c-9d0a-8165-b906-f27cc55eb8b5" class="toggle">
				<li>
					<details open="">
						<summary><strong>Ниже описаны доступные </strong><em><strong>действия </strong></em><strong>для
								правил:</strong></summary>
						<table id="131aa64c-9d0a-814e-ae0f-eb175246897c" class="simple-table">
							<tbody>
								<tr id="131aa64c-9d0a-81d7-8d4f-ef49b52a3036">
									<td id="yrWH" class=""><strong>Действие</strong></td>
									<td id="P&lt;|[" class="" style="width:540px"><strong>Описание действия</strong>
									</td>
								</tr>
								<tr id="131aa64c-9d0a-813e-b232-fe1702303e67">
									<td id="yrWH" class=""><code><strong>never</strong></code></td>
									<td id="P&lt;|[" class="" style="width:540px">Аудит не будет генерировать никаких
										записей. Это может быть использовано для подавления генерации событий. Обычно
										необходимо подавлять генерацию вверху списка, а не внизу, т.к. событие
										инициируется на первом совпавшем правиле.</td>
								</tr>
								<tr id="131aa64c-9d0a-8131-a2d3-c051ba5bb3fa">
									<td id="yrWH" class=""><code><strong>always</strong></code></td>
									<td id="P&lt;|[" class="" style="width:540px">Установить контекст аудита. Всегда
										заполнять его во время входа в системный вызов и всегда генерировать запись во
										время выхода из системного вызова.</td>
								</tr>
								<tr id="131aa64c-9d0a-81d5-95e7-db693c308f74">
									<td id="yrWH" class="">
										<code><strong>-A</strong></code><code> </code><em><code>&lt;список, действие&gt;</code></em>
									</td>
									<td id="P&lt;|[" class="" style="width:540px">Добавить правило с указанным действием
										в начало списка.</td>
								</tr>
								<tr id="131aa64c-9d0a-8176-a969-ead6f802ac45">
									<td id="yrWH" class="">
										<code><strong>-d</strong></code><code> </code><em><code>&lt;список, действие&gt;</code></em>
									</td>
									<td id="P&lt;|[" class="" style="width:540px">Удалить правило с указанным действием
										из списка. Правило удаляется только в том случае, если полностью совпали и имя
										системного вызова, и поля сравнения.</td>
								</tr>
								<tr id="131aa64c-9d0a-8198-ab00-f95754587e47">
									<td id="yrWH" class=""><code><strong>-D</strong></code></td>
									<td id="P&lt;|[" class="" style="width:540px">Удалить все правила и точки
										наблюдения.</td>
								</tr>
								<tr id="131aa64c-9d0a-8119-8e7b-fbc25ec334bf">
									<td id="yrWH" class="">
										<code><strong>-S </strong></code><em><code>&lt;имя или номер системного вызова&gt;/</code></em><code>[</code><code><strong>all</strong></code><code>]</code>
									</td>
									<td id="P&lt;|[" class="" style="width:540px">Любой номер или имя системного вызова
										может быть использован. Также возможно использование ключевого
										слова <strong>all</strong>. Если какой-либо процесс выполняет указанный
										системный вызов, то аудит генерирует соответствующую запись. Если значения полей
										сравнения заданы, а системный вызов не указан, правило будет применяться ко всем
										системным вызовам. В одном правиле может быть задано несколько системных вызовов
										- это положительно сказывается на производительности, поскольку заменяет
										обработку нескольких правил.</td>
								</tr>
								<tr id="131aa64c-9d0a-8163-9e05-cd2dcbcfa327">
									<td id="yrWH" class="">
										<code><strong>-F </strong></code><code>[n=v | n!=v | n&lt;v | n&gt;v | n&lt;=v | n&gt;=v | n&amp;v | n&amp;=v]</code>
									</td>
									<td id="P&lt;|[" class="" style="width:540px">Задать поле сравнения для правила.
										Атрибуты поля следующие: <em>объект</em>, <em>операция</em>, <em>значение</em>.
										Вы можете задать до 64 полей сравнения в одной команде. Каждое новое поле должно
										начинаться с <strong>-F</strong>. Аудит будет генерировать запись, если
										произошло совпадение по всем полями сравнения. Допустимо использование одного из
										следующих 8 операторов: <em>равно</em>, <em>не
											равно</em>, <em>меньше</em>, <em>больше</em>, <em>меньше либо
											равно</em>, <em>больше либо равно</em>, <em>битовая
											маска</em> (<strong>n&amp;v</strong>) и <em>битовая
											проверка</em> (<strong>n&amp;=v</strong>). Битовая проверка выполняет
										операцию «<strong>and</strong>» над значениями и проверяет, равны ли они.
										Битовая маска просто выполняет операцию «<strong>and</strong>». Поля,
										оперирующие с идентификатором пользователя, могут также работать с именем
										пользователя - программа автоматически получит идентификатор пользователя из его
										имени. То же самое можно сказать и про имя группы.<br />Поля сравнения могут
										быть заданы для следующих объектов:<br /><br />• <br /><strong>a0, a1, a2,
											a3</strong> - четыре первых аргумента, переданных системному вызову.
										Строковые аргументы не поддерживаются. Это связано с тем, что ядро должно
										получать указатель на строку, а проверка поля по значению адреса указателя не
										желательна. Таким образом, вы должны использовать только цифровые
										значения.<br />• <br /><strong>arch</strong> - архитектура процессора, на
										котором выполняется системный вызов. Используйте &#x27;<strong>uname
											-m</strong>&#x27;, чтобы определить архитектуру. Если вы не знаете
										архитектуру вашей машины, но хотите использовать таблицу 32-х битных системных
										вызовов, и ваша машина поддерживает 32 бита, вы можете
										использовать <strong>b32</strong>. Подобно этому <strong>b64</strong> может быть
										использовано для использования таблицы 64-х битных системных вызовов.<br />•
										<br /><strong>auid </strong>- это аббревиатура: <em>audit uid</em> -
										идентификатор пользователя, использованный для входа в систему.<br />•
										<br /><strong>devmajor</strong> - главный номер устройства (Device Major
										Number).<br />• <br /><strong>devminor</strong> - вспомогательный номер
										устройства (Device Minor Number).<br />• <br /><strong>egid</strong> -
										действительный идентификатор группы;<br />• <br /><strong>euid</strong> -
										действительный идентификатор пользователя;<br /><br />•
										<br /><strong>exit</strong> - значение, возвращаемое системным вызовом при
										выходе;<br />• <br /><strong>fsgid</strong> - идентификатор группы, применяемый
										к файловой системе;<br />• <br /><strong>fsuid</strong> - идентификатор
										пользователя, применяемый к файловой системе;<br />•
										<br /><strong>gid</strong> - идентификатор группы;<br />•
										<br /><strong>inode</strong> - номер <em>inode</em>;<br />•
										<br /><strong>key</strong> - альтернативный способ установить ключ фильтрации.
										Смотри выше описание опции <strong>-k</strong>;<br />•
										<br /><strong>msgtype </strong>используется для проверки совпадения с числом,
										описывающим тип сообщения. Может быть использован только в
										списке <strong>exclude</strong>;<br />• <br /><strong>obj_user</strong> - имя
										пользователя-владельца ресурса (в контексте SELinux);<br />•
										<br /><strong>obj_role</strong> - роль ресурса (в контексте SELinux);<br />•
										<br /><strong>obj_type</strong> - тип ресурса (в контексте SELinux);<br />•
										<br /><strong>obj_lev_low</strong> - нижний уровень ресурса (в контексте
										SELinux);<br />• <br /><strong>obj_lev_high</strong> - верхний уровень ресурса
										(в контексте SELinux);<br />• <br /><strong>path</strong> - полный путь к файлу
										для точки наблюдения. Смотри ниже описание опции
										&quot;<strong>-w</strong>&quot;. Может быть использован только в
										списке <strong>exit</strong>;<br />• <br /><strong>perm</strong> - фильтр прав
										доступа для файловых операций. Смотри выше описание опции
										&quot;<strong>-p</strong>&quot;. Может быть использован только в
										списке <strong>exit</strong>;<br />• <br /><strong>pers</strong> - персональный
										номер операционной системы;<br />• <br /><strong>pid</strong> - идентификатор
										процесса;<br />• <br /><strong>ppid</strong> - идентификатор родительского
										процесса;<br />• <br /><strong>subj_user</strong> - имя пользователя-владельца
										процесса (в контексте SELinux);<br />• <br /><strong>subj_role</strong> - роль
										процесса (в контексте SELinux);<br />• <br /><strong>subj_type</strong> - тип
										процесса (в контексте SELinux);<br />• <br /><strong>subj_sen</strong> -
										чувствительность процесса (в контексте SELinux);<br />•
										<br /><strong>subj_clr</strong> - допуск процесса (в контексте SELinux);<br />•
										<br /><strong>sgid</strong> - установленный идентификатор группы;<br />•
										<br /><strong>success</strong> - если значение, возвращаемое системным вызовом,
										больше либо равно <strong>0</strong>, данный объект будет равен
										&quot;<strong>true</strong>/<strong>yes</strong>&quot;, иначе
										&quot;<strong>false</strong>/<strong>no</strong>&quot;. При создании правила
										используйте <strong>1</strong> вместо
										&quot;<strong>true</strong>/<strong>yes</strong>&quot;
										и <strong>0</strong> вместо
										&quot;<strong>false</strong>/<strong>no</strong>&quot;;<br />•
										<br /><strong>suid</strong> - установленный идентификатор пользователя;<br />•
										<br /><strong>uid</strong> - идентификатор пользователя.</td>
								</tr>
								<tr id="131aa64c-9d0a-8142-ab07-c6ae052cc87a">
									<td id="yrWH" class="">
										<code><strong>-w</strong></code><code> </code><em><code>&lt;путь&gt;</code></em>
									</td>
									<td id="P&lt;|[" class="" style="width:540px">Добавить точку наблюдения за файловым
										объектом, находящемуся по указанному <em>пути</em>. Вы не можете добавлять точку
										наблюдения к каталогу верхнего уровня - это запрещено ядром. Групповые символы
										(wildcards) также не могут быть использованы, попытки их использования будут
										генерировать предупреждающее сообщение. Внутренне точки наблюдения реализованы
										как слежение за inode. Таким образом, если вы установите точку наблюдения за
										каталогом, вы увидите файловые события, которые в действительности будут
										означать обновления метаданных этой inode, и вы можете не увидеть событий,
										непосредственно связанных с файлами. Если вам необходимо следить за всеми
										файлами в каталоге, рекомендуется создавать индивидуальную точку наблюдения для
										каждого файла. В противоположность к правилам аудита системных вызовов, точки
										наблюдения не оказывают влияния на производительность, связанную с количеством
										правил посылаемых в ядро.</td>
								</tr>
								<tr id="131aa64c-9d0a-8142-afbc-e28d8889ec64">
									<td id="yrWH" class="">
										<code><strong>-W</strong></code><code> </code><em><code>&lt;путь&gt;</code></em>
									</td>
									<td id="P&lt;|[" class="" style="width:540px">Удалить точку наблюдения за файловым
										объектом, находящемуся по указанному <em>пути</em>.</td>
								</tr>
							</tbody>
						</table>
					</details>
				</li>
			</ul>
			<p id="131aa64c-9d0a-8138-b0d7-deb635ccb425" class="">
			</p>
			<p id="131aa64c-9d0a-818e-82a0-ebfe69423a66" class=""><strong>ПРИМЕРЫ</strong></p>
			<p id="131aa64c-9d0a-8125-a061-d8bcad563c50" class="">Чтобы увидеть все системные вызовы, используемые
				определенным процессом:</p>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
				integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
				crossorigin="anonymous" referrerPolicy="no-referrer"></script>
			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
				integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
				crossorigin="anonymous" referrerPolicy="no-referrer" />
			<pre id="131aa64c-9d0a-81d8-99e9-e4b197342693"
				class="code"><code class="language-Bash">auditctl -a entry,always -S all -F pid=1005</code></pre>
			<p id="131aa64c-9d0a-81b3-aace-ffd7880b1894" class="">Чтобы увидеть все файлы, открытые определенным
				пользователем:</p>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
				integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
				crossorigin="anonymous" referrerPolicy="no-referrer"></script>
			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
				integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
				crossorigin="anonymous" referrerPolicy="no-referrer" />
			<pre id="131aa64c-9d0a-818a-8f5c-c88c96d691dd"
				class="code"><code class="language-Bash">auditctl -a exit,always -S open -F auid=510</code></pre>
			<p id="131aa64c-9d0a-81d1-bcee-ff88817ecb90" class="">Чтобы увидеть неудачные попытки вызова системной
				функции ‘open’:</p>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
				integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
				crossorigin="anonymous" referrerPolicy="no-referrer"></script>
			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
				integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
				crossorigin="anonymous" referrerPolicy="no-referrer" />
			<pre id="131aa64c-9d0a-8178-a5e7-da0083f12165"
				class="code"><code class="language-Bash">auditctl -a exit,always -S open -F success!=0</code></pre>
			<h2 id="131aa64c-9d0a-810f-9a67-e471ec247621" class="">2.2 <strong>Конфигурационные файлы</strong></h2>
			<p id="131aa64c-9d0a-81ca-8ce3-c9bd3649cb97" class="">Правила не обязательно задавать, используя командную
				строку. Во время старта демон auditd читает два файла: /etc/audit/auditd.conf и /etc/audit/audit.rules
				(в некоторых дистрибутивах они могут находиться прямо в /etc). Первый описывает конфигурацию демона и
				содержит такие опции: как имя журнала и его формат, частота обновления и другие параметры. Нет смысла их
				изменять, разработчики дистрибутива уже позаботились о грамотной настройке.</p>
			<p id="131aa64c-9d0a-810a-9c16-ea689ea7fb17" class="">Второй файл содержит правила аудита в формате
				auditctl, поэтому все, что нужно сделать, чтобы получить правило, пригодное для записи в этот файл –
				просто опустить имя команды. Например:</p>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
				integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
				crossorigin="anonymous" referrerPolicy="no-referrer"></script>
			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
				integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
				crossorigin="anonymous" referrerPolicy="no-referrer" />
			<pre id="131aa64c-9d0a-81c8-b4d8-eef17f6469b4"
				class="code"><code class="language-Bash">-w /etc/passwd -p wa</code></pre>
			<h3 id="131aa64c-9d0a-81a3-a36e-e440c1e2b18e" class="">2.2.1 Написание своего правила</h3>
			<p id="131aa64c-9d0a-8140-9224-f1709e83c685" class=""><strong>Пропишем правило, которое позволит наблюдать
					нам за изменением файла:</strong></p>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
				integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
				crossorigin="anonymous" referrerPolicy="no-referrer"></script>
			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
				integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
				crossorigin="anonymous" referrerPolicy="no-referrer" />
			<pre id="131aa64c-9d0a-8191-858b-dd25a6653639"
				class="code"><code class="language-Bash">sudo touch audit.txt</code></pre>
			<figure id="131aa64c-9d0a-8120-95e3-e3dacd581b5a" class="image"><a
					href="https://i.imgur.com/ao2H0DY.png"><img src="https://i.imgur.com/ao2H0DY.png" /></a></figure>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
				integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
				crossorigin="anonymous" referrerPolicy="no-referrer"></script>
			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
				integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
				crossorigin="anonymous" referrerPolicy="no-referrer" />
			<pre id="131aa64c-9d0a-812d-947f-e16dea54278f"
				class="code"><code class="language-Bash">sudo auditctl -w /home/audit.txt -p wrxa -k audit_filter</code></pre>
			<p id="131aa64c-9d0a-81da-ac56-ea59d13e6025" class=""><strong>где:</strong></p>
			<ul id="131aa64c-9d0a-815f-a7c5-dc0d6b2fdaa4" class="bulleted-list">
				<li style="list-style-type:disc"><strong>-w</strong> - означает просмотр</li>
			</ul>
			<ul id="131aa64c-9d0a-81aa-86a9-c3cb65a93bfb" class="bulleted-list">
				<li style="list-style-type:disc"><strong>/home/audit.txt</strong> - путь к файлу</li>
			</ul>
			<ul id="131aa64c-9d0a-816a-8555-e26c3e03fe5d" class="bulleted-list">
				<li style="list-style-type:disc"><strong>-p wrxa</strong> — разрешение на отслеживания</li>
			</ul>
			<ul id="131aa64c-9d0a-81b7-a119-ccbf3c3cb506" class="bulleted-list">
				<li style="list-style-type:disc"><strong>-k audit_filte</strong>r — фильтрующий ключ</li>
			</ul>
			<figure id="131aa64c-9d0a-8151-b86e-c7bc12f574f3" class="image"><a
					href="https://i.imgur.com/WThzsrS.png"><img src="https://i.imgur.com/WThzsrS.png" /></a></figure>
			<h3 id="131aa64c-9d0a-8161-9fd9-e5a58a2e892d" class="">2.2.2 Редактирование файла</h3>
			<p id="131aa64c-9d0a-812a-af5b-d56155a1ed37" class="">Видим, что правило применилось, теперь внесем
				изменения в файл:</p>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
				integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
				crossorigin="anonymous" referrerPolicy="no-referrer"></script>
			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
				integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
				crossorigin="anonymous" referrerPolicy="no-referrer" />
			<pre id="131aa64c-9d0a-8190-9561-ddbb693e1651"
				class="code"><code class="language-Bash">sudo nano /home/audit.txt</code></pre>
			<figure id="131aa64c-9d0a-81ea-be3c-f2d30706c38c" class="image"><a
					href="https://i.imgur.com/adqn6Fn.png"><img src="https://i.imgur.com/adqn6Fn.png" /></a></figure>
			<h3 id="131aa64c-9d0a-81ad-8062-c5d1a0902976" class="">2.2.3 Проверка аудита</h3>
			<p id="131aa64c-9d0a-81fa-b6d0-cbaf36429752" class=""><strong>Теперь посмотрим доступ к файлу аудита с
					помощью </strong><code><strong>au-поиск аудита</strong></code><strong>:</strong></p>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
				integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
				crossorigin="anonymous" referrerPolicy="no-referrer"></script>
			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
				integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
				crossorigin="anonymous" referrerPolicy="no-referrer" />
			<pre id="131aa64c-9d0a-8176-91f0-ddef91a7b2ec"
				class="code"><code class="language-Bash">sudo ausearch -f /home/audit.txt</code></pre>
			<figure id="131aa64c-9d0a-8143-aa50-c7525a4f72f1" class="image"><a
					href="https://i.imgur.com/Yzwsowp.png"><img src="https://i.imgur.com/Yzwsowp.png" /></a></figure>
			<p id="131aa64c-9d0a-816f-8bb8-d918cc013b91" class=""><strong>где:</strong></p>
			<ul id="131aa64c-9d0a-8100-b130-e7d85d31d638" class="bulleted-list">
				<li style="list-style-type:disc">time - время изменения</li>
			</ul>
			<ul id="131aa64c-9d0a-8119-bc3c-fb1bb68d8950" class="bulleted-list">
				<li style="list-style-type:disc">auid=1000 - идентификатор пользователя</li>
			</ul>
			<ul id="131aa64c-9d0a-81e6-9842-e62e7184b5e8" class="bulleted-list">
				<li style="list-style-type:disc">comm= - с помощью чего происходило редактирование</li>
			</ul>
			<p id="131aa64c-9d0a-817d-b695-f8d9d505c76b" class=""><strong>если зайти в файл
				</strong><code><strong>/etc/passwd</strong></code><strong> и сравнить идентификатор, который мы нашли в
					аудите, то увидим, что:</strong></p>
			<figure id="131aa64c-9d0a-817d-a88c-f68f800daa6c" class="image"><a
					href="https://i.imgur.com/qN4ZKVz.png"><img src="https://i.imgur.com/qN4ZKVz.png" /></a></figure>
			<p id="131aa64c-9d0a-8128-a03f-ec66dc7ea64e" class="">идентификатор auid=1000, следовательно,
				пользователь <code>igor</code> отредактировал файл, аудит успешно ведется.</p>
			<p id="131aa64c-9d0a-8127-848e-cf4d11900eec" class=""><em><strong>Таким образом можно отслеживать изменения
						файлов</strong></em><em>.</em></p>
			<h1 id="131aa64c-9d0a-818d-90e3-dd811fa99eb1" class="">3. Создание о<strong>тчёта</strong></h1>
			<p id="131aa64c-9d0a-8164-a003-d5bf08488a7d" class=""><strong>Для построения отчёта используем
					команду:</strong></p>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
				integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
				crossorigin="anonymous" referrerPolicy="no-referrer"></script>
			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
				integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
				crossorigin="anonymous" referrerPolicy="no-referrer" />
			<pre id="131aa64c-9d0a-8175-80ae-f11b57a36d86"
				class="code"><code class="language-Bash">sudo aureport -f</code></pre>
			<figure id="131aa64c-9d0a-8172-bca1-c1d3b36eff00" class="image"><a
					href="https://i.imgur.com/5bVEaj6.png"><img src="https://i.imgur.com/5bVEaj6.png" /></a></figure>
			<h1 id="131aa64c-9d0a-8145-b4b0-ecbc58db5f6c" class="">4. <strong>Постоянный аудит</strong></h1>
			<p id="131aa64c-9d0a-816d-becf-f8babd149a35" class=""><strong> Для того, чтобы вести постоянный аудит,
					потребуется редактирование конфигурационных файлов.</strong></p>
			<p id="131aa64c-9d0a-81c3-bb95-d486d38bb5fb" class="">Для редактирования конфигурационного файла необходимо
				зайти в него:</p>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
				integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
				crossorigin="anonymous" referrerPolicy="no-referrer"></script>
			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
				integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
				crossorigin="anonymous" referrerPolicy="no-referrer" />
			<pre id="131aa64c-9d0a-8135-93ce-e41c4ee86102"
				class="code"><code class="language-Bash">sudo nano /etc/audit/rules.d/audit.rules</code></pre>
			<p id="131aa64c-9d0a-8114-af6d-ea02e45f5ec4" class="">В начале файла обычно размещаются несколько
				мета-правил, задающих конфигурацию и очищающих правила:</p>
			<p id="131aa64c-9d0a-8150-93bc-c1aca6fd2923" class=""><strong>Удаляем все правила из всех списков:
				</strong><code>-D</code></p>
			<p id="131aa64c-9d0a-817f-a57e-f197621d515c" class=""><strong>Указываем количество буферов, хранящих
					сообщения аудита:</strong><code>-b 8192</code></p>
			<p id="131aa64c-9d0a-81d1-a8bb-dbd8ca9359f6" class=""><strong>Что делать в чрезвычайной ситуации (например,
					если все буферы будут заполнены):</strong></p>
			<p id="131aa64c-9d0a-81f4-ad02-c4d76b4daab4" class=""><code>-f 1</code></p>
			<ul id="131aa64c-9d0a-81da-a773-c6f3392a9c3d" class="bulleted-list">
				<li style="list-style-type:disc">0 – ничего не делать</li>
			</ul>
			<ul id="131aa64c-9d0a-81bf-923f-fe28126977c1" class="bulleted-list">
				<li style="list-style-type:disc">1 – поместить сообщение в dmesg</li>
			</ul>
			<ul id="131aa64c-9d0a-818f-8acb-d64cd89a7de8" class="bulleted-list">
				<li style="list-style-type:disc">2 – отправить ядро в панику (kernel panic)<br /><br /></li>
			</ul>
			<p id="131aa64c-9d0a-815f-8191-cc7ae4354a42" class="">Далее можно разместить свои правила.</p>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
				integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
				crossorigin="anonymous" referrerPolicy="no-referrer"></script>
			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
				integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
				crossorigin="anonymous" referrerPolicy="no-referrer" />
			<pre id="131aa64c-9d0a-8165-8cb2-f48660ffbe6c"
				class="code"><code class="language-Bash">-w /home/audit.txt -p wrxa -k audit_filter</code></pre>
			<figure id="131aa64c-9d0a-81c1-bed5-f469668fedf4" class="image"><a
					href="https://i.imgur.com/XjTsZr4.png"><img src="https://i.imgur.com/XjTsZr4.png" /></a></figure>
			<p id="131aa64c-9d0a-818e-b3d4-d62e905c12d0" class=""><strong>Сохраняем и выходим:</strong></p>
			<p id="131aa64c-9d0a-816d-b9e6-f5e9cd570e94" class=""><em>Ctrl+O, Ctrl+X.</em></p>
			<h1 id="131aa64c-9d0a-8187-b063-d3f390f9172f" class="">5. Выполнить практику </h1>
			<figure class="block-color-gray_background callout" style=" display:flex"
				id="131aa64c-9d0a-815f-863d-da0f3953bbc9">
				<div style="font-size:1.5em"><img class="icon"
						src="https://www.notion.so/icons/exclamation-mark_red.svg" /></div>
				<div style="width:100%">К отчету приложить скриншоты выполнения каждого пункта с описанием.</div>
			</figure>
			<ol type="1" id="131aa64c-9d0a-815b-85ba-e04d1982e6ac" class="numbered-list" start="1">
				<li>Создать файл и добавить его в правила;</li>
			</ol>
			<ol type="1" id="131aa64c-9d0a-8148-b8fe-c7ff6490fed1" class="numbered-list" start="2">
				<li>Добавить пра­вило ауди­та для регис­тра­ции изме­нения фай­ла /etc/passwd; </li>
			</ol>
			<ol type="1" id="131aa64c-9d0a-8121-9418-e43e1b85c5e1" class="numbered-list" start="3">
				<li>Добавить пра­вило ауди­та для регис­тра­ции изме­нения фай­ла /etc/shadow;</li>
			</ol>
			<ol type="1" id="131aa64c-9d0a-8192-80df-d6d9a6998031" class="numbered-list" start="4">
				<li>Создать пользователя;</li>
			</ol>
			<ol type="1" id="131aa64c-9d0a-81b8-8614-daf216a56081" class="numbered-list" start="5">
				<li>Показать с помощью правила uid созданного пользователя;</li>
			</ol>
			<ol type="1" id="131aa64c-9d0a-8140-931a-e839570d2bde" class="numbered-list" start="6">
				<li>Создать директорию MIREA;</li>
			</ol>
			<ol type="1" id="131aa64c-9d0a-8135-aece-d27996609861" class="numbered-list" start="7">
				<li>Создать правило, предназначенное для наблюдения за директорией MIREA;</li>
			</ol>
			<ol type="1" id="131aa64c-9d0a-8187-a8f0-e6c3c6df0297" class="numbered-list" start="8">
				<li>Создать несколько поддиректорий, создайте или скопируйте несколько файлов, удалите несколько файлов
					или получите список ее содержимого;</li>
			</ol>
			<ol type="1" id="131aa64c-9d0a-81d7-8103-c454158c5bb7" class="numbered-list" start="9">
				<li>Обратитесь к содержимому журнала демона auditd и выведите изменения в директории MIREA;</li>
			</ol>
			<ol type="1" id="131aa64c-9d0a-811c-a412-d6ce3e1140f8" class="numbered-list" start="10">
				<li>Показать абсо­лют­но все события ауди­та за день;</li>
			</ol>
			<ol type="1" id="131aa64c-9d0a-8118-8bd5-f58de120680e" class="numbered-list" start="11">
				<li>Внести изменения в любой файл, вывести результат <strong>двумя </strong>способами: командой и
					отчётом.</li>
			</ol>
			<h1 id="131aa64c-9d0a-8111-a0af-e4fa3e1e258c" class=""><strong>Вывод</strong></h1>
			<p id="131aa64c-9d0a-81c7-a1dd-ef75762bef71" class=""><strong>В этой практической работе мы научились
					работать с auditd.</strong></p>
		</div>
	</article><span class="sans" style="font-size:14px;padding-top:2em"></span>
</body>

</html>