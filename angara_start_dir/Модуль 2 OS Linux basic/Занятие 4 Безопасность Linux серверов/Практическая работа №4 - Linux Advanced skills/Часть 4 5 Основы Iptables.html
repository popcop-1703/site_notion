<html>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>Часть 4.5 Основы Iptables</title>
	<style>
		/* cspell:disable-file */
		/* webkit printing magic: print all background colors */
		html {
			-webkit-print-color-adjust: exact;
		}

		* {
			box-sizing: border-box;
			-webkit-print-color-adjust: exact;
		}

		html,
		body {
			margin: 0;
			padding: 0;
		}

		@media only screen {
			body {
				margin: 2em auto;
				max-width: 900px;
				color: rgb(55, 53, 47);
			}
		}

		body {
			line-height: 1.5;
			/* white-space: pre-wrap; */
		}

		a,
		a.visited {
			color: inherit;
			text-decoration: underline;
		}

		.pdf-relative-link-path {
			font-size: 80%;
			color: #444;
		}

		h1,
		h2,
		h3 {
			letter-spacing: -0.01em;
			line-height: 1.2;
			font-weight: 600;
			margin-bottom: 0;
		}

		.page-title {
			font-size: 2.5rem;
			font-weight: 700;
			margin-top: 0;
			margin-bottom: 0.75em;
		}

		h1 {
			font-size: 1.875rem;
			margin-top: 1.875rem;
		}

		h2 {
			font-size: 1.5rem;
			margin-top: 1.5rem;
		}

		h3 {
			font-size: 1.25rem;
			margin-top: 1.25rem;
		}

		.source {
			border: 1px solid #ddd;
			border-radius: 3px;
			padding: 1.5em;
			word-break: break-all;
		}

		.callout {
			border-radius: 3px;
			padding: 1rem;
		}

		figure {
			margin: 1.25em 0;
			page-break-inside: avoid;
		}

		figcaption {
			opacity: 0.5;
			font-size: 85%;
			margin-top: 0.5em;
		}

		mark {
			background-color: transparent;
		}

		.indented {
			padding-left: 1.5em;
		}

		hr {
			background: transparent;
			display: block;
			width: 100%;
			height: 1px;
			visibility: visible;
			border: none;
			border-bottom: 1px solid rgba(55, 53, 47, 0.09);
		}

		img {
			max-width: 100%;
		}

		@media only print {
			img {
				max-height: 100vh;
				object-fit: contain;
			}
		}

		@page {
			margin: 1in;
		}

		.collection-content {
			font-size: 0.875rem;
		}

		.column-list {
			display: flex;
			justify-content: space-between;
		}

		.column {
			padding: 0 1em;
		}

		.column:first-child {
			padding-left: 0;
		}

		.column:last-child {
			padding-right: 0;
		}

		.table_of_contents-item {
			display: block;
			font-size: 0.875rem;
			line-height: 1.3;
			padding: 0.125rem;
		}

		.table_of_contents-indent-1 {
			margin-left: 1.5rem;
		}

		.table_of_contents-indent-2 {
			margin-left: 3rem;
		}

		.table_of_contents-indent-3 {
			margin-left: 4.5rem;
		}

		.table_of_contents-link {
			text-decoration: none;
			opacity: 0.7;
			border-bottom: 1px solid rgba(55, 53, 47, 0.18);
		}

		table,
		th,
		td {
			border: 1px solid rgba(55, 53, 47, 0.09);
			border-collapse: collapse;
		}

		table {
			border-left: none;
			border-right: none;
		}

		th,
		td {
			font-weight: normal;
			padding: 0.25em 0.5em;
			line-height: 1.5;
			min-height: 1.5em;
			text-align: left;
		}

		th {
			color: rgba(55, 53, 47, 0.6);
		}

		ol,
		ul {
			margin: 0;
			margin-block-start: 0.6em;
			margin-block-end: 0.6em;
		}

		li>ol:first-child,
		li>ul:first-child {
			margin-block-start: 0.6em;
		}

		ul>li {
			list-style: disc;
		}

		ul.to-do-list {
			padding-inline-start: 0;
		}

		ul.to-do-list>li {
			list-style: none;
		}

		.to-do-children-checked {
			text-decoration: line-through;
			opacity: 0.375;
		}

		ul.toggle>li {
			list-style: none;
		}

		ul {
			padding-inline-start: 1.7em;
		}

		ul>li {
			padding-left: 0.1em;
		}

		ol {
			padding-inline-start: 1.6em;
		}

		ol>li {
			padding-left: 0.2em;
		}

		.mono ol {
			padding-inline-start: 2em;
		}

		.mono ol>li {
			text-indent: -0.4em;
		}

		.toggle {
			padding-inline-start: 0em;
			list-style-type: none;
		}

		/* Indent toggle children */
		.toggle>li>details {
			padding-left: 1.7em;
		}

		.toggle>li>details>summary {
			margin-left: -1.1em;
		}

		.selected-value {
			display: inline-block;
			padding: 0 0.5em;
			background: rgba(206, 205, 202, 0.5);
			border-radius: 3px;
			margin-right: 0.5em;
			margin-top: 0.3em;
			margin-bottom: 0.3em;
			white-space: nowrap;
		}

		.collection-title {
			display: inline-block;
			margin-right: 1em;
		}

		.page-description {
			margin-bottom: 2em;
		}

		.simple-table {
			margin-top: 1em;
			font-size: 0.875rem;
			empty-cells: show;
		}

		.simple-table td {
			height: 29px;
			min-width: 120px;
		}

		.simple-table th {
			height: 29px;
			min-width: 120px;
		}

		.simple-table-header-color {
			background: rgb(247, 246, 243);
			color: black;
		}

		.simple-table-header {
			font-weight: 500;
		}

		time {
			opacity: 0.5;
		}

		.icon {
			display: inline-block;
			max-width: 1.2em;
			max-height: 1.2em;
			text-decoration: none;
			vertical-align: text-bottom;
			margin-right: 0.5em;
		}

		img.icon {
			border-radius: 3px;
		}

		.user-icon {
			width: 1.5em;
			height: 1.5em;
			border-radius: 100%;
			margin-right: 0.5rem;
		}

		.user-icon-inner {
			font-size: 0.8em;
		}

		.text-icon {
			border: 1px solid #000;
			text-align: center;
		}

		.page-cover-image {
			display: block;
			object-fit: cover;
			width: 100%;
			max-height: 30vh;
		}

		.page-header-icon {
			font-size: 3rem;
			margin-bottom: 1rem;
		}

		.page-header-icon-with-cover {
			margin-top: -0.72em;
			margin-left: 0.07em;
		}

		.page-header-icon img {
			border-radius: 3px;
		}

		.link-to-page {
			margin: 1em 0;
			padding: 0;
			border: none;
			font-weight: 500;
		}

		p>.user {
			opacity: 0.5;
		}

		td>.user,
		td>time {
			white-space: nowrap;
		}

		input[type="checkbox"] {
			transform: scale(1.5);
			margin-right: 0.6em;
			vertical-align: middle;
		}

		p {
			margin-top: 0.5em;
			margin-bottom: 0.5em;
		}

		.image {
			border: none;
			margin: 1.5em 0;
			padding: 0;
			border-radius: 0;
			text-align: center;
		}

		.code,
		code {
			background: rgba(135, 131, 120, 0.15);
			border-radius: 3px;
			padding: 0.2em 0.4em;
			border-radius: 3px;
			font-size: 85%;
			tab-size: 2;
		}

		code {
			color: #eb5757;
		}

		.code {
			padding: 1.5em 1em;
		}

		.code-wrap {
			white-space: pre-wrap;
			word-break: break-all;
		}

		.code>code {
			background: none;
			padding: 0;
			font-size: 100%;
			color: inherit;
		}

		blockquote {
			font-size: 1.25em;
			margin: 1em 0;
			padding-left: 1em;
			border-left: 3px solid rgb(55, 53, 47);
		}

		.bookmark {
			text-decoration: none;
			max-height: 8em;
			padding: 0;
			display: flex;
			width: 100%;
			align-items: stretch;
		}

		.bookmark-title {
			font-size: 0.85em;
			overflow: hidden;
			text-overflow: ellipsis;
			height: 1.75em;
			white-space: nowrap;
		}

		.bookmark-text {
			display: flex;
			flex-direction: column;
		}

		.bookmark-info {
			flex: 4 1 180px;
			padding: 12px 14px 14px;
			display: flex;
			flex-direction: column;
			justify-content: space-between;
		}

		.bookmark-image {
			width: 33%;
			flex: 1 1 180px;
			display: block;
			position: relative;
			object-fit: cover;
			border-radius: 1px;
		}

		.bookmark-description {
			color: rgba(55, 53, 47, 0.6);
			font-size: 0.75em;
			overflow: hidden;
			max-height: 4.5em;
			word-break: break-word;
		}

		.bookmark-href {
			font-size: 0.75em;
			margin-top: 0.25em;
		}

		.sans {
			font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol";
		}

		.code {
			font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;
		}

		.serif {
			font-family: Lyon-Text, Georgia, ui-serif, serif;
		}

		.mono {
			font-family: iawriter-mono, Nitti, Menlo, Courier, monospace;
		}

		.pdf .sans {
			font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP';
		}

		.pdf:lang(zh-CN) .sans {
			font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC';
		}

		.pdf:lang(zh-TW) .sans {
			font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC';
		}

		.pdf:lang(ko-KR) .sans {
			font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR';
		}

		.pdf .code {
			font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP';
		}

		.pdf:lang(zh-CN) .code {
			font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC';
		}

		.pdf:lang(zh-TW) .code {
			font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC';
		}

		.pdf:lang(ko-KR) .code {
			font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR';
		}

		.pdf .serif {
			font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP';
		}

		.pdf:lang(zh-CN) .serif {
			font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC';
		}

		.pdf:lang(zh-TW) .serif {
			font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC';
		}

		.pdf:lang(ko-KR) .serif {
			font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR';
		}

		.pdf .mono {
			font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP';
		}

		.pdf:lang(zh-CN) .mono {
			font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC';
		}

		.pdf:lang(zh-TW) .mono {
			font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC';
		}

		.pdf:lang(ko-KR) .mono {
			font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR';
		}

		.highlight-default {
			color: rgba(55, 53, 47, 1);
		}

		.highlight-gray {
			color: rgba(120, 119, 116, 1);
			fill: rgba(120, 119, 116, 1);
		}

		.highlight-brown {
			color: rgba(159, 107, 83, 1);
			fill: rgba(159, 107, 83, 1);
		}

		.highlight-orange {
			color: rgba(217, 115, 13, 1);
			fill: rgba(217, 115, 13, 1);
		}

		.highlight-yellow {
			color: rgba(203, 145, 47, 1);
			fill: rgba(203, 145, 47, 1);
		}

		.highlight-teal {
			color: rgba(68, 131, 97, 1);
			fill: rgba(68, 131, 97, 1);
		}

		.highlight-blue {
			color: rgba(51, 126, 169, 1);
			fill: rgba(51, 126, 169, 1);
		}

		.highlight-purple {
			color: rgba(144, 101, 176, 1);
			fill: rgba(144, 101, 176, 1);
		}

		.highlight-pink {
			color: rgba(193, 76, 138, 1);
			fill: rgba(193, 76, 138, 1);
		}

		.highlight-red {
			color: rgba(212, 76, 71, 1);
			fill: rgba(212, 76, 71, 1);
		}

		.highlight-default_background {
			color: rgba(55, 53, 47, 1);
		}

		.highlight-gray_background {
			background: rgba(241, 241, 239, 1);
		}

		.highlight-brown_background {
			background: rgba(244, 238, 238, 1);
		}

		.highlight-orange_background {
			background: rgba(251, 236, 221, 1);
		}

		.highlight-yellow_background {
			background: rgba(251, 243, 219, 1);
		}

		.highlight-teal_background {
			background: rgba(237, 243, 236, 1);
		}

		.highlight-blue_background {
			background: rgba(231, 243, 248, 1);
		}

		.highlight-purple_background {
			background: rgba(244, 240, 247, 0.8);
		}

		.highlight-pink_background {
			background: rgba(249, 238, 243, 0.8);
		}

		.highlight-red_background {
			background: rgba(253, 235, 236, 1);
		}

		.block-color-default {
			color: inherit;
			fill: inherit;
		}

		.block-color-gray {
			color: rgba(120, 119, 116, 1);
			fill: rgba(120, 119, 116, 1);
		}

		.block-color-brown {
			color: rgba(159, 107, 83, 1);
			fill: rgba(159, 107, 83, 1);
		}

		.block-color-orange {
			color: rgba(217, 115, 13, 1);
			fill: rgba(217, 115, 13, 1);
		}

		.block-color-yellow {
			color: rgba(203, 145, 47, 1);
			fill: rgba(203, 145, 47, 1);
		}

		.block-color-teal {
			color: rgba(68, 131, 97, 1);
			fill: rgba(68, 131, 97, 1);
		}

		.block-color-blue {
			color: rgba(51, 126, 169, 1);
			fill: rgba(51, 126, 169, 1);
		}

		.block-color-purple {
			color: rgba(144, 101, 176, 1);
			fill: rgba(144, 101, 176, 1);
		}

		.block-color-pink {
			color: rgba(193, 76, 138, 1);
			fill: rgba(193, 76, 138, 1);
		}

		.block-color-red {
			color: rgba(212, 76, 71, 1);
			fill: rgba(212, 76, 71, 1);
		}

		.block-color-default_background {
			color: inherit;
			fill: inherit;
		}

		.block-color-gray_background {
			background: rgba(241, 241, 239, 1);
		}

		.block-color-brown_background {
			background: rgba(244, 238, 238, 1);
		}

		.block-color-orange_background {
			background: rgba(251, 236, 221, 1);
		}

		.block-color-yellow_background {
			background: rgba(251, 243, 219, 1);
		}

		.block-color-teal_background {
			background: rgba(237, 243, 236, 1);
		}

		.block-color-blue_background {
			background: rgba(231, 243, 248, 1);
		}

		.block-color-purple_background {
			background: rgba(244, 240, 247, 0.8);
		}

		.block-color-pink_background {
			background: rgba(249, 238, 243, 0.8);
		}

		.block-color-red_background {
			background: rgba(253, 235, 236, 1);
		}

		.select-value-color-uiBlue {
			background-color: rgba(35, 131, 226, .07);
		}

		.select-value-color-pink {
			background-color: rgba(245, 224, 233, 1);
		}

		.select-value-color-purple {
			background-color: rgba(232, 222, 238, 1);
		}

		.select-value-color-green {
			background-color: rgba(219, 237, 219, 1);
		}

		.select-value-color-gray {
			background-color: rgba(227, 226, 224, 1);
		}

		.select-value-color-transparentGray {
			background-color: rgba(227, 226, 224, 0);
		}

		.select-value-color-translucentGray {
			background-color: rgba(0, 0, 0, 0.06);
		}

		.select-value-color-orange {
			background-color: rgba(250, 222, 201, 1);
		}

		.select-value-color-brown {
			background-color: rgba(238, 224, 218, 1);
		}

		.select-value-color-red {
			background-color: rgba(255, 226, 221, 1);
		}

		.select-value-color-yellow {
			background-color: rgba(253, 236, 200, 1);
		}

		.select-value-color-blue {
			background-color: rgba(211, 229, 239, 1);
		}

		.select-value-color-pageGlass {
			background-color: undefined;
		}

		.select-value-color-washGlass {
			background-color: undefined;
		}

		.checkbox {
			display: inline-flex;
			vertical-align: text-bottom;
			width: 16;
			height: 16;
			background-size: 16px;
			margin-left: 2px;
			margin-right: 5px;
		}
	</style>
</head>

<body>
	<article id="131aa64c-9d0a-818f-a7d8-ea9949cda1bf" class="page sans">
		<header><img class="page-cover-image"
				src="Часть 4 5 Основы Iptables/kandinsky-download-1705859869158.png"
				style="object-position:center 50%" />
			<div class="page-header-icon page-header-icon-with-cover"><img class="icon"
					src="https://www.notion.so/icons/log-in_gray.svg" /></div>
			<h1 class="page-title"><strong>Часть 4.5 Основы Iptables</strong></h1>
			<p class="page-description"></p>
		</header>
		<div class="page-body">
			<figure id="131aa64c-9d0a-8164-9d5a-e763abcffcdf" class="image"><a
					href="https://i.imgur.com/PP9VMLt.png"><img style="width:1440px"
						src="https://i.imgur.com/PP9VMLt.png" /></a></figure>
			<h2 id="131aa64c-9d0a-8171-bb3e-df5246182190" class=""><strong>Цель работы:</strong></h2>
			<ol type="1" id="131aa64c-9d0a-8122-8e07-fcca3c620572" class="numbered-list" start="1">
				<li>Развернуть две виртуальные машинки на ubuntu, debian <em>(можно использовать стенд
						от  </em><code><strong><a href="https://www.notion.so/349a8b49aecd444083190e8891d45093?pvs=21">Настройка сети в Linux (на примере Ubuntu)</a></strong></code><em>
						или
					</em><code><strong><a href="https://www.notion.so/8f3da27b1d814efb8d44df2583933523?pvs=21">Настройка и конфигурация Linux-систем и прав доступа на базе Debian</a></strong></code><em>
						практической работы)</em></li>
			</ol>
			<ol type="1" id="131aa64c-9d0a-812f-b5d6-fe42663b6010" class="numbered-list" start="2">
				<li>Создать правила для 12 пунктов. Записать текст правил в текстовый документ.</li>
			</ol>
			<ol type="1" id="131aa64c-9d0a-81ab-b751-ed92442c78da" class="numbered-list" start="3">
				<li>Сохранять правила с помощью штатной утилиты.</li>
			</ol>
			<h3 id="131aa64c-9d0a-814c-8d5a-c9d6c0ca6356" class=""><strong>При защите также ответьте на
					вопросы:</strong></h3>
			<ol type="1" id="131aa64c-9d0a-81c2-aefb-d14521b8508e" class="numbered-list" start="1">
				<li>INPUT - это?</li>
			</ol>
			<ol type="1" id="131aa64c-9d0a-81f0-9179-f2fd98746274" class="numbered-list" start="2">
				<li>OUTPUT - это?</li>
			</ol>
			<ol type="1" id="131aa64c-9d0a-8125-be4b-c5fa566d4291" class="numbered-list" start="3">
				<li>FORWARD - это?</li>
			</ol>
			<ol type="1" id="131aa64c-9d0a-8161-9462-e9578c9a2f2d" class="numbered-list" start="4">
				<li>Назовите основные возможности iptables</li>
			</ol>
			<h2 id="131aa64c-9d0a-81f0-8d67-f9c15118a599" class=""><strong>Задача создать правила для:</strong></h2>
			<ol type="1" id="131aa64c-9d0a-815f-b9be-ca8239b9cb98" class="numbered-list" start="1">
				<li>Установить SSH-сервер (сменить стандартный порт на любой другой (сделать скриншот терминала с именем
					пользователя файла конфигурации)) </li>
			</ol>
			<figure id="131aa64c-9d0a-8132-ab97-c17e32644e4e" class="link-to-page"><a
					href="Часть 4 5 Основы Iptables/Методическое указание “Установка и настройка серв.html"><span
						class="icon">🗂️</span>Методическое указание “Установка и настройка сервера SSH в Linux”</a>
			</figure>
			<ol type="1" id="131aa64c-9d0a-818d-9585-d6b118c4ecf3" class="numbered-list" start="1">
				<li>Установить IpTables.</li>
			</ol>
			<ol type="1" id="131aa64c-9d0a-8171-a000-e1203dc9ebbb" class="numbered-list" start="2">
				<li>Изучить работу и правила по методическому указанию, которое представлено ниже.</li>
			</ol>
			<ol type="1" id="131aa64c-9d0a-81f3-a02d-d3774c37e222" class="numbered-list" start="3">
				<li>Запретить ping – 2 способами (с возможностью записи событий в файл).</li>
			</ol>
			<ol type="1" id="131aa64c-9d0a-81c2-afd5-f398f9784a96" class="numbered-list" start="4">
				<li>Запретить ssh соединения (с возможностью записи событий в файл).</li>
			</ol>
			<ol type="1" id="131aa64c-9d0a-81a7-9d5c-f51ad3a55b10" class="numbered-list" start="5">
				<li>Запретить все соединения (с возможностью записи событий в файл).</li>
			</ol>
			<ol type="1" id="131aa64c-9d0a-8151-a129-c17f4624d8cc" class="numbered-list" start="6">
				<li>Запретить все соединения кроме ssh (с возможностью записи событий в файл).</li>
			</ol>
			<ol type="1" id="131aa64c-9d0a-81ec-928b-e359e6051023" class="numbered-list" start="7">
				<li>Запретить все соединения только по одному ip-адресу (с возможностью записи событий в файл).</li>
			</ol>
			<ol type="1" id="131aa64c-9d0a-81d1-a769-e5ee363979b6" class="numbered-list" start="8">
				<li>Запретить все соединения по одному ip-адресу, кроме ssh, подключиться по ssh (с возможностью записи
					событий в файл).</li>
			</ol>
			<ol type="1" id="131aa64c-9d0a-8126-be65-e7e2dd2e3a19" class="numbered-list" start="9">
				<li>Запретить диапазон ip-адресов по маске 255.255.255.0 (с возможностью записи событий в файл).</li>
			</ol>
			<ol type="1" id="131aa64c-9d0a-81e8-acf5-df56e8ca2046" class="numbered-list" start="10">
				<li>Запретить диапазон портов 3000-4000 в сети 255.255.0.0 (с возможностью записи событий в файл).</li>
			</ol>
			<ol type="1" id="131aa64c-9d0a-8199-9e85-edbc399e1c51" class="numbered-list" start="11">
				<li>Пробросить диапазон портов 1000-5000 на ip-адрес второй машины linux (с возможностью записи событий
					в файл).</li>
			</ol>
			<ol type="1" id="131aa64c-9d0a-8174-ae94-e1b6d650eeaf" class="numbered-list" start="12">
				<li>Создать два собственных правила исходя из потребностей рабочего процесса или домашней локальной
					сети.</li>
			</ol>
			<p id="131aa64c-9d0a-8168-9e7b-de17d40b8952" class="">
			</p>
			<h3 id="131aa64c-9d0a-8174-8b6c-d22f9e6d65b8" class="">Отчёт:</h3>
			<ul id="131aa64c-9d0a-818a-8320-e4bedcab2bfa" class="bulleted-list">
				<li style="list-style-type:disc">Приложить скриншоты с описание к отчёту.</li>
			</ul>
			<p id="131aa64c-9d0a-8153-a46f-e7b23fe9e38e" class="">
			</p>
			<h1 id="131aa64c-9d0a-8145-9f4a-ca6d6136e745" class=""><strong>Методические указания к выполнению</strong>
			</h1>
			<p id="131aa64c-9d0a-8109-9765-f757e777ba19" class="">Брандмауэр - это охрана на дверях, он защищает от
				мелких хакеров, которых подавляющее большинство. По мимо охраны у входа, деньги в банке всегда хранятся
				в сейфе. Финансовые сбережения для банка - это как секретная информация для сервера, и они должны быть
				максимально защищены. Именно поэтому устанавливают сейфы со сложными механизмами защиты , и если вор не
				знает, как их обойти, то он потратит на вскрытие замка драгоценное время, и успеет приехать полиция. В
				случае с сервером в роли сейфа может выступать шифрование, которое повышает гарантию сохранности данных.
				Даже если хакер проникнет на сервер, минуя сетевой экран, ему понадобится слишком много времени, чтобы
				расшифровать данные.</p>
			<p id="131aa64c-9d0a-81fa-874e-ed36790dee34" class=""><strong>Схематично путь пакетов через IPTABLES хорошо
					представлен на следующей схеме:</strong></p>
			<figure id="131aa64c-9d0a-8141-8134-d17b23c9ddce" class="image"><a
					href="https://i.imgur.com/D3faDET.png"><img src="https://i.imgur.com/D3faDET.png" /></a></figure>
			<h3 id="131aa64c-9d0a-81d2-958c-ea00b2d03f5e" class=""><strong>1. Конфигурирование брандмауэра</strong></h3>
			<p id="131aa64c-9d0a-8151-af38-ed11ca73fc58" class="">Сетевая система ядра Linux называется Netfilter и
				предоставляет нам фильтрацию пакетов с сохранением состояния и без него, а также NAT и IP Masquerading.
				Для управления сетевым ядром используется утилита командной строки iptables, а для управления IP 6-й
				версии - утилита ip6tables. Утилита iptables схожа по синтаксису с ipchains (использовалась для
				конфигурирования сетевого экрана до iptables), но предоставляет нам больше возможностей. Сама команда
				имеет в простейшем варианте такой вид:</p>
			<p id="131aa64c-9d0a-817f-8a46-ef92f1f2a1a0" class=""><code>iptables команда [ключи]</code></p>
			<p id="131aa64c-9d0a-8152-a99e-d2200aec3d96" class="">Команда, как правило, включает в себя указание
				цепочки, т.е. набора правил, применяемых в определённых случаях. В систему встроены несколько цепочек,
				которые постоянны и не могут быть удалены. Вот основные из них:</p>
			<ul id="131aa64c-9d0a-81fa-8624-e2b7c383e98b" class="bulleted-list">
				<li style="list-style-type:disc">INPUT - входные данные;</li>
			</ul>
			<ul id="131aa64c-9d0a-8159-a0d3-d99279800bfe" class="bulleted-list">
				<li style="list-style-type:disc">OUTPUT - выходные данные;</li>
			</ul>
			<ul id="131aa64c-9d0a-8152-bc6a-e5388bbf98ae" class="bulleted-list">
				<li style="list-style-type:disc">FORWARD - перенаправление.</li>
			</ul>
			<p id="131aa64c-9d0a-8171-a2b2-c97c10b9ad12" class="">Давайте посмотрим на пример, который разрешает любой
				трафик на локальном интерфейсе loopback. Этот интерфейс есть на каждом компьютере и указывает на него
				самого. Он безопасен, ибо по сети этот интерфейс никто не видит, поэтому на нём можно разрешить всё.
				Итак, команда выглядит следующим образом:</p>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
				integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
				crossorigin="anonymous" referrerPolicy="no-referrer"></script>
			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
				integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
				crossorigin="anonymous" referrerPolicy="no-referrer" />
			<pre id="131aa64c-9d0a-8107-b468-ea86f60b7e61"
				class="code"><code class="language-Bash">iptables -I INPUT 1 -i lo -p all -j ACCEPT</code></pre>
			<p id="131aa64c-9d0a-8181-92e9-d23c7a4711bb" class="">Ничего не понятно? Страшно, аж жуть? Если вы впервые
				видите команды управления сетевым экраном Linux, то только такие чувства могут вызвать на первых порах
				параметры утилиты iptables. Но ничего, хороший мануал и немного практики, и вы не будете бояться этих
				правил. Пока не будем рассматривать команды, а погрузимся в теорию и изучим, какие параметры может
				принимать команда iptables.</p>
			<h2 id="131aa64c-9d0a-81b4-8032-f3fa2872001a" class="">Ключи iptables и примеры их использования</h2>
			<h3 id="131aa64c-9d0a-81bc-9beb-c803e7f2ca12" class="">Для работы с таблицами (iptables -t)</h3>
			<p id="131aa64c-9d0a-812e-9047-c0142b79c6e5" class="">Напоминаю, все правила в netfilter распределены по
				таблицам. Чтобы работать с конкретной таблицей, необходимо использовать ключ -t.</p>
			<table id="131aa64c-9d0a-819e-b2ee-d92a32b44981" class="simple-table">
				<tbody>
					<tr id="131aa64c-9d0a-81cd-9fbc-ffb5268ff727">
						<td id="?toC" class=""><strong>Ключ</strong></td>
						<td id="PYlJ" class="" style="width:764px"><strong>Описание</strong></td>
					</tr>
					<tr id="131aa64c-9d0a-8126-bd19-f3e2c7bfb3ea">
						<td id="?toC" class="">-t filter</td>
						<td id="PYlJ" class="" style="width:764px">Таблица по умолчанию. С ней работаем, если упускаем
							ключ -t. Встроены три цепочки — INPUT (входящие), OUTPUT (исходящие) и FORWARD (проходящие
							пакеты)</td>
					</tr>
					<tr id="131aa64c-9d0a-812d-8b60-f69901c890a9">
						<td id="?toC" class="">-t nat</td>
						<td id="PYlJ" class="" style="width:764px">Для пакетов, устанавливающий новое соединение. По
							умолчанию, встроены три цепочки — PREROUTING (изменение входящих), OUTPUT (изменение
							локальных пакетов перед отправкой) и POSTROUTING (изменение всех исходящих).</td>
					</tr>
					<tr id="131aa64c-9d0a-8123-8d4d-c12deb35b5b3">
						<td id="?toC" class="">-t mangle</td>
						<td id="PYlJ" class="" style="width:764px">Для изменения пакетов. Цепочки — INPUT, OUTPUT,
							FORWARD, PREROUTING, POSTROUTING.</td>
					</tr>
					<tr id="131aa64c-9d0a-81cf-8f95-c5e10835a6d4">
						<td id="?toC" class="">-t raw</td>
						<td id="PYlJ" class="" style="width:764px">Для создания исключений в слежении за соединениями.
							Цепочки: PREROUTING, OUTPUT.</td>
					</tr>
				</tbody>
			</table>
			<h3 id="131aa64c-9d0a-810f-9047-d31d1a55e476" class=""><strong>Команды</strong></h3>
			<p id="131aa64c-9d0a-81e8-9154-da85db4eef43" class=""><em>Нижеперечисленные ключи определяют действия,
					которые выполняет утилита iptables.</em></p>
			<table id="131aa64c-9d0a-8187-8456-d6f6ecc15c17" class="simple-table">
				<tbody>
					<tr id="131aa64c-9d0a-8150-8762-f008a656dfed">
						<td id="PcBG" class=""><strong>Ключ</strong></td>
						<td id="gnm?" class="" style="width:763px"><strong>Описание и примеры</strong></td>
					</tr>
					<tr id="131aa64c-9d0a-810e-8b94-c34bd30b1fd7">
						<td id="PcBG" class="">-A</td>
						<td id="gnm?" class="" style="width:763px">Добавление правила в конец
							списка:<em><strong>iptables -A INPUT -s 192.168.0.15 -j DROP </strong></em><em>запретить
								входящие с 192.168.0.15.</em></td>
					</tr>
					<tr id="131aa64c-9d0a-8174-932a-da2824bf8050">
						<td id="PcBG" class="">-D</td>
						<td id="gnm?" class="" style="width:763px">Удаление правила:<em><strong>iptables -D INPUT 10
								</strong></em><em>удалить правило в цепочке INPUT с номером 10.</em></td>
					</tr>
					<tr id="131aa64c-9d0a-8102-8a4a-cfe3f70a087d">
						<td id="PcBG" class="">-I</td>
						<td id="gnm?" class="" style="width:763px">Вставка правила в определенную часть
							списка:<em><strong>iptables -I INPUT 5 -s 192.168.0.15 -j DROP </strong></em><em>вставить
								правило 5-м по списку.</em></td>
					</tr>
					<tr id="131aa64c-9d0a-8185-bcbe-d38f40316a62">
						<td id="PcBG" class="">-R</td>
						<td id="gnm?" class="" style="width:763px">Замена правила.<em><strong>iptables -R OUTPUT 5
									-s 192.168.0.15 -j ACCEPT </strong></em><em>заменить наше 5-е правило с запрещающего
								на разрешающее.</em></td>
					</tr>
					<tr id="131aa64c-9d0a-8108-bd57-ec9e5abaa2df">
						<td id="PcBG" class="">-F</td>
						<td id="gnm?" class="" style="width:763px">Сброс правил в цепочке.<em><strong>iptables -F
									INPUT</strong></em></td>
					</tr>
					<tr id="131aa64c-9d0a-818e-a37d-d8dd1366a5b7">
						<td id="PcBG" class="">-Z</td>
						<td id="gnm?" class="" style="width:763px">Обнуление статистики.<em><strong>iptables -Z
									INPUT</strong></em></td>
					</tr>
					<tr id="131aa64c-9d0a-8136-a415-ee104797cfe0">
						<td id="PcBG" class="">-N</td>
						<td id="gnm?" class="" style="width:763px">Создание цепочки.<em><strong>iptables -N
									CHAINNEW</strong></em></td>
					</tr>
					<tr id="131aa64c-9d0a-81b2-bb4e-c434724d41c0">
						<td id="PcBG" class="">-X</td>
						<td id="gnm?" class="" style="width:763px">Удаление цепочки.<em><strong>iptables -X
									CHAINNEW</strong></em></td>
					</tr>
					<tr id="131aa64c-9d0a-81ae-a8b0-cf1a69049c62">
						<td id="PcBG" class="">-P</td>
						<td id="gnm?" class="" style="width:763px">Определение правила по
							умолчанию.<em><strong>iptables -P INPUT DROP</strong></em></td>
					</tr>
					<tr id="131aa64c-9d0a-81ee-963f-e2e4055c2f24">
						<td id="PcBG" class="">-E</td>
						<td id="gnm?" class="" style="width:763px">Переименование цепочки.<em><strong>iptables -E
									CHAINNEW CHAINOLD</strong></em></td>
					</tr>
				</tbody>
			</table>
			<h3 id="131aa64c-9d0a-810e-a1f1-e3d46441b1c9" class="">Условия</h3>
			<p id="131aa64c-9d0a-810f-ac35-ef8659f01105" class="">Данные ключи определяют условия правила.</p>
			<table id="131aa64c-9d0a-81f1-9144-caf0a76c9320" class="simple-table">
				<tbody>
					<tr id="131aa64c-9d0a-8126-bbaa-ed8dc26c109d">
						<td id="BYGf" class=""><strong>Ключ</strong></td>
						<td id="y@vi" class="" style="width:765px"><strong>Описание и примеры</strong></td>
					</tr>
					<tr id="131aa64c-9d0a-81bc-a737-cad04c9f3c53">
						<td id="BYGf" class="">-p</td>
						<td id="y@vi" class="" style="width:765px">Сетевой протокол. Допустимые варианты — TCP, UDP,
							ICMP или ALL.<em><strong>iptables -A INPUT -p tcp -j ACCEPT </strong></em><em>разрешить все
								входящие tcp-соединения.</em></td>
					</tr>
					<tr id="131aa64c-9d0a-8127-b127-db093e6a4e5c">
						<td id="BYGf" class="">-s</td>
						<td id="y@vi" class="" style="width:765px">Адрес источника — имя хоста, IP-адрес или подсеть в
							нотации CIDR.<em><strong>iptables -A INPUT -s 192.168.0.50 -j DROP
								</strong></em><em>запретить входящие с узла 192.168.0.50</em></td>
					</tr>
					<tr id="131aa64c-9d0a-815c-95c1-c0f7b28c835e">
						<td id="BYGf" class="">-d</td>
						<td id="y@vi" class="" style="width:765px">Адрес назначения. Принцип использования аналогичен
							предыдущему ключу -s.<em><strong>iptables -A OUTPUT -d 192.168.0.50 -j DROP
								</strong></em><em>запретить исходящие на узел 192.168.0.50</em></td>
					</tr>
					<tr id="131aa64c-9d0a-81af-8a3d-c0d6114e45bb">
						<td id="BYGf" class="">-i</td>
						<td id="y@vi" class="" style="width:765px">Сетевой адаптер, через который приходят пакеты
							(INPUT).<em><strong>iptables -A INPUT -i eth2 -j DROP </strong></em><em>запретить входящие
								для Ethernet-интерфейса eth2.</em></td>
					</tr>
					<tr id="131aa64c-9d0a-8135-b8b4-f070d4b1426a">
						<td id="BYGf" class="">-o</td>
						<td id="y@vi" class="" style="width:765px">Сетевой адаптер, с которого уходят пакеты
							(OUTPUT).<em><strong>iptables -A OUTPUT -o eth3 -j ACCEPT </strong></em><em>разрешить
								исходящие с Ethernet-интерфейса eth3.</em></td>
					</tr>
					<tr id="131aa64c-9d0a-81d1-acad-fb5a5f9713d4">
						<td id="BYGf" class="">--dport</td>
						<td id="y@vi" class="" style="width:765px">Порт назначения.<em><strong>iptables -A INPUT -p tcp
									--dport 80 -j ACCEPT </strong></em><em>разрешить входящие на порт 80.</em></td>
					</tr>
					<tr id="131aa64c-9d0a-81c0-bc5e-f4ce7b395043">
						<td id="BYGf" class="">--sport</td>
						<td id="y@vi" class="" style="width:765px">Порт источника.<em><strong>iptables -A INPUT -p tcp
									--sport 1023 -j DROP </strong></em><em>запретить входящие с порта 1023.</em></td>
					</tr>
				</tbody>
			</table>
			<h3 id="131aa64c-9d0a-81a3-af6d-cf0b60ea61ff" class="">Действия</h3>
			<p id="131aa64c-9d0a-81c7-adaa-c8e80c20e9e0" class="">Действия, которые будут выполняться над пакетом,
				подходящим под критерии условия. Для каждой таблицы есть свой набор допустимых действий. Указываются с
				использованием ключа <strong>-j</strong>.</p>
			<h3 id="131aa64c-9d0a-81fa-9585-d655bd49fd41" class="">Действия</h3>
			<p id="131aa64c-9d0a-811d-82d4-c0316e3b211e" class="">Действия, которые будут выполняться над пакетом,
				подходящим под критерии условия. Для каждой таблицы есть свой набор допустимых действий. Указываются с
				использованием ключа <strong>-j</strong>.</p>
			<p id="131aa64c-9d0a-8186-bd4f-f97a1f1e4c96" class=""><strong>Таблица filter:</strong></p>
			<table id="131aa64c-9d0a-810c-b120-f908b24957d4" class="simple-table">
				<thead class="simple-table-header">
					<tr id="131aa64c-9d0a-81fc-9f82-dfabfae5a17e">
						<th id="Q[`]" class="simple-table-header-color simple-table-header">Действие</th>
						<th id="]Zx?" class="simple-table-header-color simple-table-header" style="width:697px">Описание
						</th>
					</tr>
				</thead>
				<tbody>
					<tr id="131aa64c-9d0a-81f8-a8d7-dfbe61c14ea7">
						<td id="Q[`]" class="">ACCEPT</td>
						<td id="]Zx?" class="" style="width:697px">Разрешает пакет.</td>
					</tr>
					<tr id="131aa64c-9d0a-81f7-8a85-dab2baaa9708">
						<td id="Q[`]" class="">DROP</td>
						<td id="]Zx?" class="" style="width:697px">Запрещает пакет.</td>
					</tr>
					<tr id="131aa64c-9d0a-8196-b706-c61b076e60bf">
						<td id="Q[`]" class="">REJECT</td>
						<td id="]Zx?" class="" style="width:697px">Запрещает с отправкой сообщения источнику.</td>
					</tr>
				</tbody>
			</table>
			<p id="131aa64c-9d0a-81dd-a52f-c0a4a98b2676" class=""><strong>Таблица nat:</strong></p>
			<table id="131aa64c-9d0a-8143-a8b1-c747bf97edc0" class="simple-table">
				<thead class="simple-table-header">
					<tr id="131aa64c-9d0a-813f-bb61-e086d250a5db">
						<th id="Q[`]" class="simple-table-header-color simple-table-header">Действие</th>
						<th id="]Zx?" class="simple-table-header-color simple-table-header" style="width:698px">Описание
						</th>
					</tr>
				</thead>
				<tbody>
					<tr id="131aa64c-9d0a-81b9-aac1-f4630b9a3796">
						<td id="Q[`]" class="">MASQUERADE</td>
						<td id="]Zx?" class="" style="width:698px">Для исходящих пакетов заменяет IP-адрес источника на
							адрес интерфейса, с которого уходит пакет.</td>
					</tr>
					<tr id="131aa64c-9d0a-8180-945c-e376a94c8899">
						<td id="Q[`]" class="">SNAT</td>
						<td id="]Zx?" class="" style="width:698px">Аналогично MASQUERADE, но с указанием конкретного
							сетевого интерфейса, чей адрес будет использоваться для подмены. </td>
					</tr>
					<tr id="131aa64c-9d0a-8174-abf2-c6fd161de745">
						<td id="Q[`]" class="">DNAT</td>
						<td id="]Zx?" class="" style="width:698px">Подмена адреса для входящих пакетов.</td>
					</tr>
					<tr id="131aa64c-9d0a-813e-991f-e14bd92935bb">
						<td id="Q[`]" class="">REDIRECT</td>
						<td id="]Zx?" class="" style="width:698px">Перенаправляет запрос на другой порт той же самой
							системы.</td>
					</tr>
				</tbody>
			</table>
			<p id="131aa64c-9d0a-8142-a241-f9822c183eaf" class=""><strong>Таблица nagle:</strong></p>
			<table id="131aa64c-9d0a-8169-a445-cf6afa0533b2" class="simple-table">
				<thead class="simple-table-header">
					<tr id="131aa64c-9d0a-8106-88a3-fc062ae81fe4">
						<th id="Q[`]" class="simple-table-header-color simple-table-header">Действие</th>
						<th id="]Zx?" class="simple-table-header-color simple-table-header" style="width:699px">Описание
						</th>
					</tr>
				</thead>
				<tbody>
					<tr id="131aa64c-9d0a-81dd-a45a-f0ce24cbe85b">
						<td id="Q[`]" class="">TOS</td>
						<td id="]Zx?" class="" style="width:699px">Видоизменение поля TOS (приоритезация трафика).</td>
					</tr>
					<tr id="131aa64c-9d0a-8189-a30e-c7de7a6be812">
						<td id="Q[`]" class="">DSCP</td>
						<td id="]Zx?" class="" style="width:699px">Изменение DSCP (тоже приоритезация трафика).</td>
					</tr>
					<tr id="131aa64c-9d0a-81ae-a96e-f16b5641ab64">
						<td id="Q[`]" class="">TTL</td>
						<td id="]Zx?" class="" style="width:699px">Изменение TTL (время жизни пакета).</td>
					</tr>
					<tr id="131aa64c-9d0a-8143-b172-e8601920fe90">
						<td id="Q[`]" class="">HL</td>
						<td id="]Zx?" class="" style="width:699px">Аналогично TTL, но для IPv6.</td>
					</tr>
					<tr id="131aa64c-9d0a-8104-99ab-d9c348b52477">
						<td id="Q[`]" class="">MARK</td>
						<td id="]Zx?" class="" style="width:699px">Маркировка пакета. Используется для последующей
							фильтрации или шейпинга.</td>
					</tr>
					<tr id="131aa64c-9d0a-81ae-9345-c9810a6ee7e5">
						<td id="Q[`]" class="">CONNMARK</td>
						<td id="]Zx?" class="" style="width:699px">Маркировка соединения.</td>
					</tr>
					<tr id="131aa64c-9d0a-8195-bc2a-e61fafba804a">
						<td id="Q[`]" class="">TCPMSS</td>
						<td id="]Zx?" class="" style="width:699px">Изменение значения MTU.</td>
					</tr>
				</tbody>
			</table>
			<h1 id="131aa64c-9d0a-81f6-8ad1-c26d97d3ecfe" class=""><strong>2. Основные возможности iptables</strong>
			</h1>
			<p id="131aa64c-9d0a-81c5-b5b5-d53a6aa1988d" class=""><strong>Вот список основных параметров, которые можно
					передавать команде iptables.</strong></p>
			<ul id="131aa64c-9d0a-81e9-8e96-cd43a931339d" class="bulleted-list">
				<li style="list-style-type:disc"><code>A</code> цепочка правило — добавить правило в конец цепочки. В
					качестве параметра указывается имя цепочки INPUT, OUTPUT или FORWARD;</li>
			</ul>
			<ul id="131aa64c-9d0a-81f8-907a-c824850bb010" class="bulleted-list">
				<li style="list-style-type:disc"><code>D</code> цепочка номер — удалить правило с указанным номером из
					заданной цепочки;</li>
			</ul>
			<ul id="131aa64c-9d0a-818a-8065-e334e7f2df29" class="bulleted-list">
				<li style="list-style-type:disc"><code>R</code> цепочка номер правило — заменить правило с указанным
					номером в цепочке;</li>
			</ul>
			<ul id="131aa64c-9d0a-81d4-9cb5-e5efbf9fff45" class="bulleted-list">
				<li style="list-style-type:disc"><code>I</code> цепочка номер правило — вставить правило в указанную
					первым аргументом цепочку под номером, заданным во втором параметре. Если номер равен 1, то правило
					станет первым в цепочке;</li>
			</ul>
			<ul id="131aa64c-9d0a-81f3-928a-fbe882fef556" class="bulleted-list">
				<li style="list-style-type:disc"><code>L</code> цепочка — просмотреть содержимое указанной цепочки;</li>
			</ul>
			<ul id="131aa64c-9d0a-81b8-833a-c29e3bff6bb7" class="bulleted-list">
				<li style="list-style-type:disc"><code>F</code> цепочка — удалить все правила из цепочки;</li>
			</ul>
			<ul id="131aa64c-9d0a-8118-bd3f-ea46ed41cdb9" class="bulleted-list">
				<li style="list-style-type:disc"><code>р</code> протокол — определяет протокол, на который воздействует
					правило;</li>
			</ul>
			<ul id="131aa64c-9d0a-81cd-90b3-f253b2d6f357" class="bulleted-list">
				<li style="list-style-type:disc"><code>i</code> интерфейс — определяет сетевой интерфейс, с которого
					данные были получены. Здесь можно использовать INPUT, FORWARD или PREROUTING;</li>
			</ul>
			<ul id="131aa64c-9d0a-8171-b4a6-de81d059e5c8" class="bulleted-list">
				<li style="list-style-type:disc"><code>o</code> интерфейс — задает интерфейс, на который направляется
					пакет. Здесь можно указывать OUTPUT, FORWARD или POSTROUTING;</li>
			</ul>
			<ul id="131aa64c-9d0a-813e-af05-d6d9a015acb6" class="bulleted-list">
				<li style="list-style-type:disc"><code>j</code> действие — операция, которая должна быть выполнена над
					пакетом. В качестве аргументов можно указать следующие значения (рассмотрим только основные): а) LOG
					— поместить в журнал запись о получении пакета; б) REJECT — отправителю будет направлено сообщение
					об ошибке; в) DROP — удалить пакет; г) BLOCK — блокировать пакеты;</li>
			</ul>
			<ul id="131aa64c-9d0a-81be-8884-f5e9671d3537" class="bulleted-list">
				<li style="list-style-type:disc"><code>s</code> адрес — IP-адрес отправителя пакета. Как и в случае с
					iptables, после адреса можно задать маску в виде /mask и знак отрицания “!”, что будет
					соответствовать любым адресам, кроме указанных;</li>
			</ul>
			<ul id="131aa64c-9d0a-8130-a03a-f531013d7599" class="bulleted-list">
				<li style="list-style-type:disc"><code>d</code> адрес — адрес назначения пакета.</li>
			</ul>
			<p id="131aa64c-9d0a-8197-b2f4-e5160c5b2554" class="">Если ты знаком с ipchains, то должны заметить
				невероятное сходство. Но есть и очень существенные различия. Например, с помощью ключей -o и -i очень
				просто указывать, с какого и на какой интерфейс направляется пакет.</p>
			<p id="131aa64c-9d0a-814e-b2eb-cf58f49c55c0" class="">Сразу же необходимо заметить, что для сохранения
				цепочек iptables нужно выполнить команду:</p>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
				integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
				crossorigin="anonymous" referrerPolicy="no-referrer"></script>
			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
				integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
				crossorigin="anonymous" referrerPolicy="no-referrer" />
			<pre id="131aa64c-9d0a-8150-bf49-e16b7bac864b"
				class="code"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">service iptables save</code></pre>
			<p id="131aa64c-9d0a-817c-9e52-c9e09e78d918" class="">Если не сохранить правила, то они будут действовать
				только до первой перезагрузки, после которой настройки будут сброшены, и всё придётся настраивать
				заново. А оно тебе нужно?)</p>
			<p id="131aa64c-9d0a-817f-a6b4-fff801ed5153" class="">Теперь пора переходить к практическим примерам
				конфигурирования сетевого экрана. Ключ -P служит для указания значения по умолчанию. А что должно быть
				по умолчанию для максимальной защиты? Конечно же, запрет. Чтобы запретить любые входящие, исходящие и
				переадресуемые пакеты, выполняем команды:</p>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
				integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
				crossorigin="anonymous" referrerPolicy="no-referrer"></script>
			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
				integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
				crossorigin="anonymous" referrerPolicy="no-referrer" />
			<pre id="131aa64c-9d0a-8113-88d7-fe25927aa4df" class="code"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">iptables -P INPUT DROP
iptables -P OUTPUT DROP
iptables -P FORWARD DROP</code></pre>
			<p id="131aa64c-9d0a-8188-bb31-df2a60944f64" class="">Рассмотрим эти команды подробнее. После имени команды
				идёт ключ, который указывает, что мы делаем. Ключ -P говорит, что мы задаём значение по умолчанию.</p>
			<p id="131aa64c-9d0a-81de-9b65-ce818094b3bc" class="">После этого должно идти имя цепочки, куда добавляется
				правило. В первом случае это цепочка INPUT, а значит, правило будет действовать на входящие данные.</p>
			<p id="131aa64c-9d0a-812f-b5c5-e433e27de804" class="">Во втором - OUTPUT, т.е. на исходящие данные, а в
				третьем случае - FORWARD.Последний параметр цепочек - DROP - говорит о том, что нужно делать с пакетами,
				удовлетворяющими условиям, которые мы узнали. А говорит он о необходимости их удаления.</p>
			<p id="131aa64c-9d0a-818d-b05b-fb601048a68d" class="">Давайте сделаем небольшое лирическое отступление,
				чтобы понять разницу между REJECT и DROP. В качестве последнего параметра (действия) можно указать
				вместо DROP значение REJECT, что тоже будет являться запретом. Разница в том, что в случае REJECT
				отправитель запроса получит уведомление о том, что запрошенный доступ для него запрещён. Что не есть
				хорошо - ведь это лишняя информация, которую хакеру не нужно знать. При ключе DROP полученный
				запрещенный пакет будет просто удалён без каких-либо уведомлений и предупреждений.</p>
			<p id="131aa64c-9d0a-817c-a3ab-f8938353aab5" class="">Если стоит выбор между REJECT и DROP, а вы не знаете,
				что выбрать, я рекомендую выбирать DROP.Некоторые специалисты по безопасности рекомендуют журналировать
				обращения, добавив в сетевой экран фильтр:</p>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
				integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
				crossorigin="anonymous" referrerPolicy="no-referrer"></script>
			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
				integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
				crossorigin="anonymous" referrerPolicy="no-referrer" />
			<pre id="131aa64c-9d0a-8101-bda5-fc3e9df59292"
				class="code"><code class="language-Bash">iptables -A INPUT -j LOG</code></pre>
			<p id="131aa64c-9d0a-81b1-8b53-f6eb4b3a9265" class="">Я бы не рекомендовал это делать. У публичных серверов
				за день происходит несколько сотен, а то и тысяч сканирований портов. Если обращать внимание на каждую
				такую попытку, вам придётся устанавливать на сервер слишком большие жесткие диски для хранения журналов.
				А ведь если диск будет заполнен, то система выйдет из строя. Соответственно, хакер может просто
				направить бесконечные обращения на запрещённый порт и через некоторое время добиться удачно завершённой
				DoS-атаки.</p>
			<p id="131aa64c-9d0a-81fc-aa32-c743727be09b" class="">Чтобы лучше понять работу фильтрации, желательно
				увидеть как можно больше примеров, поэтому дальше мы будем много практиковаться. Для начала посмотрим
				классический пример указания прав доступа, необходимых любому веб-серверу, т.е. разрешение обращений к
				80-му порту нашего компьютера и возврат данных от нашего компьютера:</p>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
				integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
				crossorigin="anonymous" referrerPolicy="no-referrer"></script>
			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
				integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
				crossorigin="anonymous" referrerPolicy="no-referrer" />
			<pre id="131aa64c-9d0a-8154-81a8-e1ad2a7b20ce" class="code"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">iptables -A INPUT -p tcp -m tcp --dport 80 -j ACCEPT
iptables -A OUTPUT -p tcp -m tcp --sport 80 -j ACCEPT</code></pre>
			<p id="131aa64c-9d0a-815c-b00c-f2a61befbfcc" class="">В первой строке мы добавляем новое правило в цепочку
				INPUT. Правило действует на протокол TCP, о чём говорит значение tcp ключа -m. Веб-сервер использует как
				раз этот протокол для передачи данных. С помощью ключа --dport указываем порт назначения данных: 80. И
				наконец, последний параметр -j ACCEPT указывает, что если пакет соответствует всем правилам, то нужно
				его пропустить и обработать.</p>
			<p id="131aa64c-9d0a-819d-b8f4-d79b7684135b" class="">Сложно? Попробую другими словами: первая строка
				разрешает любые входящие пакеты по протоколу TCP, в которых происходит подключение на порт 80. Вторая
				строка разрешает передавать ответы от сервера.</p>
			<p id="131aa64c-9d0a-818f-bf48-f0d5323eb3ae" class="">Для того чтобы разрешить подключения по HTTPS, нужно
				добавить следующие две строки:</p>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
				integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
				crossorigin="anonymous" referrerPolicy="no-referrer"></script>
			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
				integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
				crossorigin="anonymous" referrerPolicy="no-referrer" />
			<pre id="131aa64c-9d0a-81fe-af35-c96dc7e81f38" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">iptables -A INPUT -p tcp -m tcp --dport 443 -j ACCEPT
iptables -A OUTPUT -p tcp -m tcp --sport 443 -j ACCEPT</code></pre>
			<p id="131aa64c-9d0a-81a4-bb19-e46de4f3d737" class="">Здесь делается то же самое, только разрешается работа
				с портом 443.</p>
			<p id="131aa64c-9d0a-81ca-a934-fb4c9cfc88fe" class="">Следующий пример разрешает подключения по SSH.</p>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
				integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
				crossorigin="anonymous" referrerPolicy="no-referrer"></script>
			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
				integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
				crossorigin="anonymous" referrerPolicy="no-referrer" />
			<pre id="131aa64c-9d0a-813c-bd66-c75a3b53f049" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">iptables -A INPUT -p tcp --dport 22 -j ACCEPT
iptables -A OUTPUT -p udp --sport 22 -j ACCEPT</code></pre>
			<p id="131aa64c-9d0a-817b-9983-d044ef01cb38" class="">Следующая команда создаёт фильтр, по которому
				запрещается принимать Echo-запросы от любых компьютеров:</p>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
				integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
				crossorigin="anonymous" referrerPolicy="no-referrer"></script>
			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
				integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
				crossorigin="anonymous" referrerPolicy="no-referrer" />
			<pre id="131aa64c-9d0a-8134-871d-c982c96dd430"
				class="code"><code class="language-Bash">iptables -A INPUT -s 0/0 -d localhost \ -p icmp --icmp-type echo-request -j DROP</code></pre>
			<p id="131aa64c-9d0a-81ca-93d3-e14a82b8b932" class="">Здесь параметр -s 0/0 определяет, что правило
				относится ко всем адресам отправителя. Как и всегда в таких случаях, символ \ указывает на то, что
				следующая строка является продолжением предыдущей. Вы можете убрать этот символ и записать всё в одну
				строку.</p>
			<p id="131aa64c-9d0a-81cc-9595-d22f4de3a7be" class="">Следующая команда запрещает доступ к FTP-порту:</p>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
				integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
				crossorigin="anonymous" referrerPolicy="no-referrer"></script>
			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
				integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
				crossorigin="anonymous" referrerPolicy="no-referrer" />
			<pre id="131aa64c-9d0a-8132-92bf-cdc731257183"
				class="code"><code class="language-Bash">iptables -A INPUT -s 0/0 -d localhost -p tcp --dport 21 -j DROP</code></pre>
			<p id="131aa64c-9d0a-81c2-a753-d63ed5e2dbc8" class="">Чтобы запретить доступ с определенного интерфейса,
				добавим ключ -i и укажем интерфейс eth0:</p>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
				integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
				crossorigin="anonymous" referrerPolicy="no-referrer"></script>
			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
				integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
				crossorigin="anonymous" referrerPolicy="no-referrer" />
			<pre id="131aa64c-9d0a-814b-8883-e87448b4a035"
				class="code"><code class="language-Bash">iptables -A INPUT -i eth0 -s 0/0 -d localhost -p tcp --dport 21 -j DROP</code></pre>
			<p id="131aa64c-9d0a-817b-a7d0-f802901b1e83" class="">Теперь запретим исходящие пакеты с порта 21. Для этого
				используем команду:</p>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
				integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
				crossorigin="anonymous" referrerPolicy="no-referrer"></script>
			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
				integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
				crossorigin="anonymous" referrerPolicy="no-referrer" />
			<pre id="131aa64c-9d0a-8133-a3ec-c4d117b3b64f"
				class="code"><code class="language-Bash">iptables -A OUTPUT -i eth0 -s localhost -d 0/0 -p tcp --dport 21 -j DROP</code></pre>
			<p id="131aa64c-9d0a-81fa-9fb9-d1d17df8ee77" class="">Очень мощной особенностью iptables является
				возможность проверки содержимого пакетов. Это очень удобно, например, для фильтрации веб-запрос. Можно
				разрешить доступ к порту 80, но контролировать, чтобы пакеты содержали только допустимые параметры.
				Допустим, что мы хотим разрешить доступ к FTP-серверу, но при этом быть уверенными, что пользователь не
				сможет обратиться к файлам /etc/passwd и /etc/shadow.Для этого можно запретить пакеты, в которых есть
				этот текст. Если хакер попытается послать запрос, содержащий ссылки на эти файлы, то такой пакет будет
				отклонен. Следующие команды запрещают доступ к этим файлам по протоколу FTP и WWW:</p>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
				integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
				crossorigin="anonymous" referrerPolicy="no-referrer"></script>
			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
				integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
				crossorigin="anonymous" referrerPolicy="no-referrer" />
			<pre id="131aa64c-9d0a-81a9-ae10-faf40a03c980" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">iptables -A INPUT -m string --string &quot;/etc/passwd&quot; \ -s 0/0 -d localhost -p tcp --dport 21 -j DROP

iptables -A INPUT -m string --string &quot;/etc/shadow&quot; \ -s 0/0 -d localhost -p tcp --dport 21 -j DROP

iptables -A INPUT -m string --string &quot;/etc/passwd&quot; \ -s 0/0 -d localhost -p tcp --dport 80 -j DROP

iptables -A INPUT -m string --string &quot;/etc/shadow&quot; \ -s 0/0 -d localhost -p tcp --dport 80 -j DROP
</code></pre>
			<p id="131aa64c-9d0a-8178-9efa-d858c440d67f" class="">Надо также учесть аспект защиты информации. Допустим,
				что у вас есть сервер, который принимает закодированный трафик с помощью stunnel (Security Tunnel,
				безопасный туннель), расшифровывает и передает его на другую машину. В этом случае во входящих пакетах
				сетевой экран не сможет найти такие строки. А вот исходящие пакеты идут уже декодированными и содержат
				открытый текст команд. В такой конфигурации необходимо контролировать оба потока. Даже если у вас
				stunnel передаёт расшифрованный трафик на другой порт внутри одного компьютера, можно включить контроль
				любых пакетов на всех интерфейсах, чтобы они проверялись после расшифровки.</p>
			<h1 id="131aa64c-9d0a-819a-9ccc-db5fca77d157" class=""><strong>3. Переадресация</strong></h1>
			<p id="131aa64c-9d0a-8141-a083-c1bf478e12ea" class="">Для разрешения переадресации с помощью iptables нужно
				выполнить следующую команду:</p>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
				integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
				crossorigin="anonymous" referrerPolicy="no-referrer"></script>
			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
				integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
				crossorigin="anonymous" referrerPolicy="no-referrer" />
			<pre id="131aa64c-9d0a-81fd-9843-c126cc0a8c32"
				class="code"><code class="language-Bash">iptables -A FORWARD -o ppp0 -j MASQUERADE</code></pre>
			<p id="131aa64c-9d0a-8129-9e63-eaeadf97a305" class="">В этой строке позволяется переадресация на интерфейс
				ppp0. С помощью параметра -j мы требуем прятать IP-адрес отправителя, т.е. включаем маскарадинг. Кроме
				того, можно использовать NAT (Network Address Translation, трансляция сетевых адресов). Для чего нужна
				трансляция? Сетевых IP-адресов на всех не хватает, поэтому локальные сети используют адреса из
				зарезервированного диапазона (10.x.x.x или 192.168.x.x). Эти адреса не маршрутизируются и не могут
				использоваться в Интернете. Но как же тогда использовать в таких сетях Интернет? Все пакеты,
				направляемые на адреса в Интернете, перенаправляются на шлюз, на котором работает NAT. С помощью NAT
				адрес компьютера из локальной сети подменяется интернет-адресом, и пакет продолжает свой путь из
				локальной сети во Всемирную. Таким образом, достаточно иметь только один интернет-адрес, который
				присваивается шлюзу, и вся локальная сеть сможет работать с ресурсами Всемирной сети. Для настройки NAT
				команда может выглядеть следующим образом:</p>
			<p id="131aa64c-9d0a-8192-853b-e2d97851b094" class="">
				<code>iptables -t nat -A FORWARD -o ppp0 -j MASQUERADE</code></p>
			<p id="131aa64c-9d0a-8142-aea5-d8e10b1a3b10" class="">Ключ -t nat указывает на необходимость загрузить
				модуль iptables_nat. Если он не загружен, то это легко сделать вручную с помощью следующей команды:</p>
			<p id="131aa64c-9d0a-814e-8e0c-e600526d8122" class=""><code>modprobe iptables_nat</code></p>
			<p id="131aa64c-9d0a-8131-a5af-c148fa247627" class="">Здесь iptable_nat - модуль ядра, который позволяет
				сетевому экрану работать с NAT.</p>
			<h1 id="131aa64c-9d0a-813b-8e9c-f882cdc45465" class=""><strong>4. Пишем правило</strong></h1>
			<p id="131aa64c-9d0a-8119-b888-f2aff0e15e3d" class="">Отлично, теперь давайте приближаться к практике. Как
				Вы уже поняли, мы будем писать правила, поэтому нам нужно понять, как они строятся.</p>
			<p id="131aa64c-9d0a-81f5-87d0-e708041e38de" class="">Итак, допустим у нас есть хост с адресом 192.168.2.17,
				на 80 (http) порту которого, работает веб-сервер Apache. Мы заходим на
				адрес <code>http://192.168.2.17</code> с хоста с адресом 192.168.2.2 и всё отлично работает:</p>
			<figure id="131aa64c-9d0a-81cc-b0ee-cedb8c897771" class="image"><a
					href="https://i.imgur.com/a82y3lB.png"><img src="https://i.imgur.com/a82y3lB.png" /></a></figure>
			<p id="131aa64c-9d0a-819f-a077-fbfddffeeb4e" class="">А теперь открываем командную строку под root на хосте
				192.168.2.17 и пишем:</p>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
				integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
				crossorigin="anonymous" referrerPolicy="no-referrer"></script>
			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
				integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
				crossorigin="anonymous" referrerPolicy="no-referrer" />
			<pre id="131aa64c-9d0a-81ae-a4f7-fe04bc66753f"
				class="code"><code class="language-Bash">iptables -A INPUT -p tcp -s 192.168.2.2 --dport 80 -j DROP</code></pre>
			<p id="131aa64c-9d0a-810f-a924-de4332cf9372" class=""><strong>Попробуем открыть
					открыть </strong><code><strong>http://192.168.2.17</strong></code><strong> ещё раз:</strong></p>
			<figure id="131aa64c-9d0a-8140-ac60-fe2bdc92497c" class="image"><a
					href="https://i.imgur.com/jEIc53L.png"><img src="https://i.imgur.com/jEIc53L.png" /></a></figure>
			<p id="131aa64c-9d0a-811b-b13a-e4838c7926f6" class=""><em>Упс, не работает. Давайте теперь разбираться, что
					мы наделали?</em></p>
			<p id="131aa64c-9d0a-81b4-b705-cfecd1855e4e" class=""><strong>Всё очень просто – данной командой
					мы:</strong></p>
			<p id="131aa64c-9d0a-81b4-bc9c-cb93dcb90600" class=""><strong>вызвали утилиту iptables;</strong></p>
			<ul id="131aa64c-9d0a-8194-9f04-de5549b73b30" class="bulleted-list">
				<li style="list-style-type:disc"><code>A</code> - этим ключом мы указали, что нужно добавить правило к
					существующей цепочке;</li>
			</ul>
			<ul id="131aa64c-9d0a-812c-a8dc-e7d4b857a414" class="bulleted-list">
				<li style="list-style-type:disc"><code>INPUT</code> - указали цепочку, к которой хотим добавить правило;
				</li>
			</ul>
			<ul id="131aa64c-9d0a-8154-8cf5-e5a81cffe3e4" class="bulleted-list">
				<li style="list-style-type:disc"><code>p</code> tcp - явно указали протокол TCP. Здесь также можно
					указывать другие протоколы (udp, icmp, sctp), или номер протокола, инкапсулируемого в IP (17 – udp,
					6 – tcp и др.);</li>
			</ul>
			<ul id="131aa64c-9d0a-8130-931b-e49c1c9e7611" class="bulleted-list">
				<li style="list-style-type:disc"><code>s</code> 192.168.2.2 - указали, какой адрес источника должен быть
					у пакета, который мы хотим фильтровать;</li>
			</ul>
			<ul id="131aa64c-9d0a-8108-85ab-cd13145100ca" class="bulleted-list">
				<li style="list-style-type:disc"><code>–dport</code> 80 - указали адресованные какому порту пакеты мы
					хотим фильтровать. В данном случае - 80, на котором работает наш сервер Apache.</li>
			</ul>
			<ul id="131aa64c-9d0a-814a-9712-c0847ea36fb5" class="bulleted-list">
				<li style="list-style-type:disc"><code>j</code> DROP - указали что нужно сделать с пакетом, параметры
					которого совпали с данными критериями. В данном случае – просто тихо выбросить.</li>
			</ul>
			<p id="131aa64c-9d0a-81bb-a0b9-fc9f2ebde9a5" class="">Таким образом, мы заблокировали все пакеты с адреса
				192.168.2.2 на локальный порт 80 и тем самым закрыли доступ к нашему серверу Apache для данного хоста.
			</p>
			<p id="131aa64c-9d0a-815b-b520-ef91053b7a5b" class=""><em>Обратите внимание – мы не указывали таблицу, в
					цепочки которой мы хотим добавить правило. Поэтому, по умолчанию таблица - filter. Для явного
					указания таблицы нужно перед указанием цепочки ввести ключ -t или (–table)</em></p>
			<p id="131aa64c-9d0a-81e9-9d4f-d953151fb516" class=""><strong>Чтобы открыть доступ опять просто поменяем
					ключ -A в правиле на -D, тем самым мы удалим данное правило из iptables.</strong></p>
			<p id="131aa64c-9d0a-81b2-a196-d84a209ef851" class="">На самом деле в iptables очень богатый синтаксис
				правил. Полный список ключей и параметров вы можете найти в официальном гайде на <strong><a
						href="https://iptables.org/">iptables.org</a></strong>.</p>
			<p id="131aa64c-9d0a-8108-a50f-e69b6f624f24" class="">Для удобства, в iptables реализовано очень много
				сокращений для разных ключей. Например, мы писали ключ -A вместо полного --append, -p вместо полного
				--proto и -s вместо полного --source.</p>
		</div>
	</article><span class="sans" style="font-size:14px;padding-top:2em"></span>
</body>

</html>